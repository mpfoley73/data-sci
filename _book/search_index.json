[
["discrete-anal.html", "Chapter 4 Discrete Analysis ", " Chapter 4 Discrete Analysis "],
["goodness-of-fit-test.html", "4.1 Goodness-of-Fit Test", " 4.1 Goodness-of-Fit Test These notes rely heavily upon PSU STATS 504 course notes. The chi-square goodness-of-fit test, tests whether observed frequency counts \\(O_j\\) of the \\(j \\in k\\) levels of a categorical variable differ from expected frequency counts \\(E_j\\) (\\(H_0\\) is \\(O_j = E_j, \\hspace{5mm} \\forall j \\in k\\). There are two test statistics for this test, Pearson \\(X^2\\) and deviance \\(G^2\\). The sampling distribution of each test statistic approach the chi-squared distribution as \\(n\\) becomes large. Calculate both test statistic. If the resulting p-values are close, then you can be confident that the large-sample approximation is working well. The Pearson goodness-of-fit statistic is \\[X^2 = \\sum \\frac{(O_j - E_j)^2}{E_j}\\] where \\(O_j = p_j n\\) and \\(E_j = \\pi_j n\\). The deviance statistic is \\[G^2 = 2 \\sum O_j \\log \\left( \\frac{O_j}{E_j} \\right)\\] If the saturated model (the observed data represent the fit of the saturated model, the most complex model possible with the data) proportions \\(p_j\\) equal equal the expected proportions \\(\\pi_j\\), \\(X^2\\) and \\(G^2\\) are zero. Large values indicate the data do not agree well with the proposed model. As \\(n \\rightarrow \\infty\\), \\(G^2\\) and \\(X^2\\) approach \\(\\chi_{k-1}^2\\) where \\(k\\) is the number of categorical variable levels. You can therefore run a chi-square test of significance using the \\(G^2\\) and \\(X^2\\) test statistics. The chi-square test provides reliable results when at least 80% of \\(E_j &gt;= 5\\). 4.1.1 One-Way Tables A one-way frequency table is a frequency table for a single categorical table. Here is a simple chi-square test. A researcher crosses tall cut-leaf tomatoes with dwarf potato-leaf tomatoes, then classifies the (\\(n = 1611\\)) offspring phenotypes. o &lt;- c(926, 288, 293, 104) cell_names &lt;- c(&quot;tall cut-leaf&quot;, &quot;tall potato-leaf&quot;, &quot;dwarf cut-leaf&quot;, &quot;dwarf potato-leaf&quot;) names(o) &lt;- cell_names print(o) ## tall cut-leaf tall potato-leaf dwarf cut-leaf dwarf potato-leaf ## 926 288 293 104 The genetic theory is the four phenotypes should occur with relative frequencies 9 : 3 : 3 : 1. pi &lt;- c(9, 3, 3, 1) / (9 + 3 + 3 + 1) e &lt;- 1611 * pi names(e) &lt;- cell_names print(e) ## tall cut-leaf tall potato-leaf dwarf cut-leaf dwarf potato-leaf ## 906.1875 302.0625 302.0625 100.6875 data.frame(o, e) %&gt;% rownames_to_column() %&gt;% pivot_longer(cols = -rowname) %&gt;% ggplot(aes(x = as.factor(rowname), y = value, fill = name)) + geom_col(position = position_dodge()) + geom_text(aes(label = round(value, 0)), position = position_dodge(width = 0.9)) + theme_mf() + scale_fill_mf() + labs(title = &quot;Observed vs Expected&quot;, fill = &quot;&quot;, x = &quot;&quot;, y = &quot;&quot;) The \\(X^2\\) statistic is x2 &lt;- sum((o - e)^2 / e) = 1.468722 and the \\(G^2\\) statistic is g2 &lt;- 2 * sum(o * log(o / e)) = 1.4775868, so nearly identical. The chi-sq test p-values are also nearly identical. pchisq(q = x2, df = length(o) - 1, lower.tail = FALSE) ## [1] 0.6895079 pchisq(q = g2, df = length(o) - 1, lower.tail = FALSE) ## [1] 0.6874529 alpha &lt;- 0.05 df &lt;- length(e) - 1 lrr = -Inf urr = qchisq(p = alpha, df = df, lower.tail = FALSE) # data.frame(chi2 = 0:2500 / 100) %&gt;% # mutate(density = dchisq(x = chi2, df = df)) %&gt;% # mutate(rr = ifelse(chi2 &lt; lrr | chi2 &gt; urr, density, 0)) %&gt;% # ggplot() + # geom_line(aes(x = chi2, y = density)) + # geom_area(aes(x = chi2, y = rr), fill = &quot;red&quot;, alpha = 0.3) + # # geom_vline(aes(xintercept = pi_0), color = &quot;black&quot;) + # geom_vline(aes(xintercept = chisq), color = &quot;red&quot;) + # labs(title = bquote(&quot;Chi-Squared Goodness-of-Fit Test&quot;), # subtitle = bquote(&quot;Chisq =&quot;~.(round(chisq,2))~&quot;, n =&quot;~.(n)~&quot;, alpha =&quot;~.(alpha)~&quot;, chisq_crit =&quot;~.(round(urr,2))~&quot;, p-value =&quot;~.(round(p_value,3))), # x = &quot;chisq&quot;, # y = &quot;Density&quot;) + # theme(legend.position=&quot;none&quot;) Replace the summation with a square root in the test statistic formulas to get the Pearson and deviance residuals. e2_res &lt;- sqrt((o - e)^2 / e) g2_res &lt;- sign(o - e) * sqrt(abs(2 * o * log(o / e))) Here is a summary of the analysis. data.frame(o, e, e2_res, g2_res) ## o e e2_res g2_res ## tall cut-leaf 926 906.1875 0.6581581 6.328906 ## tall potato-leaf 288 302.0625 0.8091222 -5.240221 ## dwarf cut-leaf 293 302.0625 0.5214343 -4.224967 ## dwarf potato-leaf 104 100.6875 0.3301172 2.594764 You can perform the chi-square test of the Pearson test statistic with chisq.test(). chisq.test(o, p = pi) ## ## Chi-squared test for given probabilities ## ## data: o ## X-squared = 1.4687, df = 3, p-value = 0.6895 "]
]
