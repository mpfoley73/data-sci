<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>7.3 Ordinal Logistic Regression | My Data Science Notes</title>
  <meta name="description" content="This is a compendium of notes from classes, tutorials, etc. that I reference from time to time." />
  <meta name="generator" content="bookdown 0.17 and GitBook 2.6.7" />

  <meta property="og:title" content="7.3 Ordinal Logistic Regression | My Data Science Notes" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a compendium of notes from classes, tutorials, etc. that I reference from time to time." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="7.3 Ordinal Logistic Regression | My Data Science Notes" />
  
  <meta name="twitter:description" content="This is a compendium of notes from classes, tutorials, etc. that I reference from time to time." />
  

<meta name="author" content="Michael Foley" />


<meta name="date" content="2020-03-10" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="multinomial-logistic-regression.html"/>
<link rel="next" href="poisson-regression.html"/>
<script src="assets/jquery-2.2.3/jquery.min.js"></script>
<link href="assets/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">My Data Science Notes</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Intro</a></li>
<li class="chapter" data-level="1" data-path="probability.html"><a href="probability.html"><i class="fa fa-check"></i><b>1</b> Probability</a><ul>
<li class="chapter" data-level="1.1" data-path="principles.html"><a href="principles.html"><i class="fa fa-check"></i><b>1.1</b> Principles</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="disc-dist.html"><a href="disc-dist.html"><i class="fa fa-check"></i><b>2</b> Discrete Distributions</a><ul>
<li class="chapter" data-level="2.1" data-path="bernoulli.html"><a href="bernoulli.html"><i class="fa fa-check"></i><b>2.1</b> Bernoulli</a></li>
<li class="chapter" data-level="2.2" data-path="binomial.html"><a href="binomial.html"><i class="fa fa-check"></i><b>2.2</b> Binomial</a></li>
<li class="chapter" data-level="2.3" data-path="poission.html"><a href="poission.html"><i class="fa fa-check"></i><b>2.3</b> Poission</a></li>
<li class="chapter" data-level="2.4" data-path="multinomial.html"><a href="multinomial.html"><i class="fa fa-check"></i><b>2.4</b> Multinomial</a></li>
<li class="chapter" data-level="2.5" data-path="negative-binomial.html"><a href="negative-binomial.html"><i class="fa fa-check"></i><b>2.5</b> Negative-Binomial</a></li>
<li class="chapter" data-level="2.6" data-path="geometric.html"><a href="geometric.html"><i class="fa fa-check"></i><b>2.6</b> Geometric</a></li>
<li class="chapter" data-level="2.7" data-path="hypergeometric.html"><a href="hypergeometric.html"><i class="fa fa-check"></i><b>2.7</b> Hypergeometric</a></li>
<li class="chapter" data-level="2.8" data-path="gamma.html"><a href="gamma.html"><i class="fa fa-check"></i><b>2.8</b> Gamma</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="cont-dist.html"><a href="cont-dist.html"><i class="fa fa-check"></i><b>3</b> Continuous Distributions</a><ul>
<li class="chapter" data-level="3.1" data-path="normal.html"><a href="normal.html"><i class="fa fa-check"></i><b>3.1</b> Normal</a><ul>
<li class="chapter" data-level="3.1.1" data-path="normal.html"><a href="normal.html#example-2"><i class="fa fa-check"></i><b>3.1.1</b> Example</a></li>
<li class="chapter" data-level="3.1.2" data-path="normal.html"><a href="normal.html#example-3"><i class="fa fa-check"></i><b>3.1.2</b> Example</a></li>
<li class="chapter" data-level="3.1.3" data-path="normal.html"><a href="normal.html#example-4"><i class="fa fa-check"></i><b>3.1.3</b> Example</a></li>
<li class="chapter" data-level="3.1.4" data-path="normal.html"><a href="normal.html#normal-approximation-to-binomial"><i class="fa fa-check"></i><b>3.1.4</b> Normal Approximation to Binomial</a></li>
<li class="chapter" data-level="3.1.5" data-path="normal.html"><a href="normal.html#example-5"><i class="fa fa-check"></i><b>3.1.5</b> Example</a></li>
<li class="chapter" data-level="3.1.6" data-path="normal.html"><a href="normal.html#example-6"><i class="fa fa-check"></i><b>3.1.6</b> Example</a></li>
<li class="chapter" data-level="3.1.7" data-path="normal.html"><a href="normal.html#from-sample-to-population"><i class="fa fa-check"></i><b>3.1.7</b> From Sample to Population</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="join-distributions.html"><a href="join-distributions.html"><i class="fa fa-check"></i><b>3.2</b> Join Distributions</a></li>
<li class="chapter" data-level="3.3" data-path="likelihood.html"><a href="likelihood.html"><i class="fa fa-check"></i><b>3.3</b> Likelihood</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="discrete-variables.html"><a href="discrete-variables.html"><i class="fa fa-check"></i><b>4</b> Discrete Variables</a><ul>
<li class="chapter" data-level="4.1" data-path="chi-square-test.html"><a href="chi-square-test.html"><i class="fa fa-check"></i><b>4.1</b> Chi-Square Test</a></li>
<li class="chapter" data-level="4.2" data-path="one-way-tables.html"><a href="one-way-tables.html"><i class="fa fa-check"></i><b>4.2</b> One-Way Tables</a><ul>
<li class="chapter" data-level="4.2.1" data-path="one-way-tables.html"><a href="one-way-tables.html#chi-square-goodness-of-fit-test"><i class="fa fa-check"></i><b>4.2.1</b> Chi-Square Goodness-of-Fit Test</a></li>
<li class="chapter" data-level="4.2.2" data-path="one-way-tables.html"><a href="one-way-tables.html#proportion-test"><i class="fa fa-check"></i><b>4.2.2</b> Proportion Test</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="two-way-tables.html"><a href="two-way-tables.html"><i class="fa fa-check"></i><b>4.3</b> Two-Way Tables</a><ul>
<li class="chapter" data-level="4.3.1" data-path="two-way-tables.html"><a href="two-way-tables.html#chi-square-independence-test"><i class="fa fa-check"></i><b>4.3.1</b> Chi-Square Independence Test</a></li>
<li class="chapter" data-level="4.3.2" data-path="two-way-tables.html"><a href="two-way-tables.html#residuals-analysis"><i class="fa fa-check"></i><b>4.3.2</b> Residuals Analysis</a></li>
<li class="chapter" data-level="4.3.3" data-path="two-way-tables.html"><a href="two-way-tables.html#difference-in-proportions"><i class="fa fa-check"></i><b>4.3.3</b> Difference in Proportions</a></li>
<li class="chapter" data-level="4.3.4" data-path="two-way-tables.html"><a href="two-way-tables.html#relative-risk"><i class="fa fa-check"></i><b>4.3.4</b> Relative Risk</a></li>
<li class="chapter" data-level="4.3.5" data-path="two-way-tables.html"><a href="two-way-tables.html#odds-ratio"><i class="fa fa-check"></i><b>4.3.5</b> Odds Ratio</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="example-of-chi-square-test-of-homogeneity.html"><a href="example-of-chi-square-test-of-homogeneity.html"><i class="fa fa-check"></i><b>4.4</b> Example of Chi-Square Test of Homogeneity</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="inference.html"><a href="inference.html"><i class="fa fa-check"></i><b>5</b> Inference</a></li>
<li class="chapter" data-level="6" data-path="regression.html"><a href="regression.html"><i class="fa fa-check"></i><b>6</b> Regression</a></li>
<li class="chapter" data-level="7" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html"><i class="fa fa-check"></i><b>7</b> Generalized Linear Models</a><ul>
<li class="chapter" data-level="7.1" data-path="logistic-regression.html"><a href="logistic-regression.html"><i class="fa fa-check"></i><b>7.1</b> Logistic Regression</a><ul>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html#example-7"><i class="fa fa-check"></i>Example</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="multinomial-logistic-regression.html"><a href="multinomial-logistic-regression.html"><i class="fa fa-check"></i><b>7.2</b> Multinomial Logistic Regression</a></li>
<li class="chapter" data-level="7.3" data-path="ordinal-logistic-regression.html"><a href="ordinal-logistic-regression.html"><i class="fa fa-check"></i><b>7.3</b> Ordinal Logistic Regression</a></li>
<li class="chapter" data-level="7.4" data-path="poisson-regression.html"><a href="poisson-regression.html"><i class="fa fa-check"></i><b>7.4</b> Poisson Regression</a><ul>
<li class="chapter" data-level="" data-path="poisson-regression.html"><a href="poisson-regression.html#example-8"><i class="fa fa-check"></i>Example</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="classification.html"><a href="classification.html"><i class="fa fa-check"></i><b>8</b> Classification</a></li>
<li class="chapter" data-level="9" data-path="classification-1.html"><a href="classification-1.html"><i class="fa fa-check"></i><b>9</b> Classification</a></li>
<li class="chapter" data-level="10" data-path="decision-trees.html"><a href="decision-trees.html"><i class="fa fa-check"></i><b>10</b> Decision Trees</a><ul>
<li class="chapter" data-level="10.1" data-path="classification-tree.html"><a href="classification-tree.html"><i class="fa fa-check"></i><b>10.1</b> Classification Tree</a><ul>
<li class="chapter" data-level="10.1.1" data-path="classification-tree.html"><a href="classification-tree.html#confusion-matrix"><i class="fa fa-check"></i><b>10.1.1</b> Confusion Matrix</a></li>
<li class="chapter" data-level="10.1.2" data-path="classification-tree.html"><a href="classification-tree.html#roc-curve"><i class="fa fa-check"></i><b>10.1.2</b> ROC Curve</a></li>
<li class="chapter" data-level="10.1.3" data-path="classification-tree.html"><a href="classification-tree.html#caret-approach"><i class="fa fa-check"></i><b>10.1.3</b> Caret Approach</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="regression-trees.html"><a href="regression-trees.html"><i class="fa fa-check"></i><b>10.2</b> Regression Trees</a><ul>
<li class="chapter" data-level="10.2.1" data-path="regression-trees.html"><a href="regression-trees.html#caret-approach-1"><i class="fa fa-check"></i><b>10.2.1</b> Caret Approach</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="bagging.html"><a href="bagging.html"><i class="fa fa-check"></i><b>10.3</b> Bagging</a></li>
<li class="chapter" data-level="10.4" data-path="random-forests.html"><a href="random-forests.html"><i class="fa fa-check"></i><b>10.4</b> Random Forests</a></li>
<li class="chapter" data-level="10.5" data-path="gradient-boosting.html"><a href="gradient-boosting.html"><i class="fa fa-check"></i><b>10.5</b> Gradient Boosting</a></li>
<li class="chapter" data-level="10.6" data-path="summary.html"><a href="summary.html"><i class="fa fa-check"></i><b>10.6</b> Summary</a></li>
<li class="chapter" data-level="10.7" data-path="reference.html"><a href="reference.html"><i class="fa fa-check"></i><b>10.7</b> Reference</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="regularization.html"><a href="regularization.html"><i class="fa fa-check"></i><b>11</b> Regularization</a></li>
<li class="chapter" data-level="12" data-path="non-linear-models.html"><a href="non-linear-models.html"><i class="fa fa-check"></i><b>12</b> Non-linear Models</a><ul>
<li class="chapter" data-level="12.1" data-path="splines.html"><a href="splines.html"><i class="fa fa-check"></i><b>12.1</b> Splines</a></li>
<li class="chapter" data-level="12.2" data-path="mars.html"><a href="mars.html"><i class="fa fa-check"></i><b>12.2</b> MARS</a></li>
<li class="chapter" data-level="12.3" data-path="gam.html"><a href="gam.html"><i class="fa fa-check"></i><b>12.3</b> GAM</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="support-vector-machines.html"><a href="support-vector-machines.html"><i class="fa fa-check"></i><b>13</b> Support Vector Machines</a><ul>
<li class="chapter" data-level="13.1" data-path="maximal-margin-classifier.html"><a href="maximal-margin-classifier.html"><i class="fa fa-check"></i><b>13.1</b> Maximal Margin Classifier</a></li>
<li class="chapter" data-level="13.2" data-path="support-vector-classifier.html"><a href="support-vector-classifier.html"><i class="fa fa-check"></i><b>13.2</b> Support Vector Classifier</a></li>
<li class="chapter" data-level="13.3" data-path="support-vector-machines-1.html"><a href="support-vector-machines-1.html"><i class="fa fa-check"></i><b>13.3</b> Support Vector Machines</a></li>
<li class="chapter" data-level="13.4" data-path="example-9.html"><a href="example-9.html"><i class="fa fa-check"></i><b>13.4</b> Example</a></li>
<li class="chapter" data-level="13.5" data-path="using-caret.html"><a href="using-caret.html"><i class="fa fa-check"></i><b>13.5</b> Using Caret</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="principal-components-analysis.html"><a href="principal-components-analysis.html"><i class="fa fa-check"></i><b>14</b> Principal Components Analysis</a></li>
<li class="chapter" data-level="15" data-path="clustering.html"><a href="clustering.html"><i class="fa fa-check"></i><b>15</b> Clustering</a></li>
<li class="chapter" data-level="16" data-path="text-mining.html"><a href="text-mining.html"><i class="fa fa-check"></i><b>16</b> Text Mining</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html"><i class="fa fa-check"></i>Appendix</a><ul>
<li class="chapter" data-level="" data-path="publishing-to-bookdown.html"><a href="publishing-to-bookdown.html"><i class="fa fa-check"></i>Publishing to BookDown</a></li>
<li class="chapter" data-level="" data-path="shiny-apps.html"><a href="shiny-apps.html"><i class="fa fa-check"></i>Shiny Apps</a></li>
<li class="chapter" data-level="" data-path="packages.html"><a href="packages.html"><i class="fa fa-check"></i>Packages</a><ul>
<li class="chapter" data-level="" data-path="packages.html"><a href="packages.html#create-a-package"><i class="fa fa-check"></i>Create a package</a></li>
<li class="chapter" data-level="16.0.1" data-path="packages.html"><a href="packages.html#document-functions-with-roxygen"><i class="fa fa-check"></i><b>16.0.1</b> Document Functions with roxygen</a></li>
<li class="chapter" data-level="" data-path="packages.html"><a href="packages.html#create-data"><i class="fa fa-check"></i>Create Data</a></li>
<li class="chapter" data-level="" data-path="packages.html"><a href="packages.html#create-vignette"><i class="fa fa-check"></i>Create Vignette</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">My Data Science Notes</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ordinal-logistic-regression" class="section level2">
<h2><span class="header-section-number">7.3</span> Ordinal Logistic Regression</h2>
<p>The following notes rely heavily on <a href="https://data.library.virginia.edu/fitting-and-interpreting-a-proportional-odds-model/">this UVA web page</a> and [PSU STAT 504 class notes](<a href="https://online.stat.psu.edu/stat504/node/171/" class="uri">https://online.stat.psu.edu/stat504/node/171/</a>.</p>
<p>The ordinal logistic regression model is</p>
<p><span class="math display">\[logit[P(Y \le j)] = \alpha_j - \beta X, \hspace{5mm} j \in [1, J-1]\]</span>
where <span class="math inline">\(j \in [1, J-1]\)</span> are the levels of the ordinal outcome variable <span class="math inline">\(Y\)</span>. The proportional odds model assumes there is a common set of slope parameters <span class="math inline">\(\beta\)</span> for the predictors. The ordinal outcomes are distinguished by the <span class="math inline">\(J-1\)</span> intercepts <span class="math inline">\(\alpha_j\)</span>. The benchmark level is <span class="math inline">\(J\)</span>. “Logit” means log-odds, so <span class="math inline">\(logit[P(Y \le j)] = \log[P(Y \le j) / P(Y \gt j)]\)</span>.</p>
<p>Suppose we want to model the probability a respondent holds a political ideology [“Very Liberal”, “Slightly Liberal”, “Moderate”, “Slightly Conservative”, “Very Conservative”] given their party affiliation [“Republican”, “Democrat”].</p>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb260-1"><a href="ordinal-logistic-regression.html#cb260-1"></a>ideo &lt;-<span class="st"> </span><span class="kw">c</span>(</span>
<span id="cb260-2"><a href="ordinal-logistic-regression.html#cb260-2"></a>  <span class="st">&quot;Very Liberal&quot;</span>,</span>
<span id="cb260-3"><a href="ordinal-logistic-regression.html#cb260-3"></a>  <span class="st">&quot;Slightly Liberal&quot;</span>,</span>
<span id="cb260-4"><a href="ordinal-logistic-regression.html#cb260-4"></a>  <span class="st">&quot;Moderate&quot;</span>,</span>
<span id="cb260-5"><a href="ordinal-logistic-regression.html#cb260-5"></a>  <span class="st">&quot;Slightly Conservative&quot;</span>,</span>
<span id="cb260-6"><a href="ordinal-logistic-regression.html#cb260-6"></a>  <span class="st">&quot;Very Conservative&quot;</span></span>
<span id="cb260-7"><a href="ordinal-logistic-regression.html#cb260-7"></a>)</span>
<span id="cb260-8"><a href="ordinal-logistic-regression.html#cb260-8"></a>ideo_cnt_rep &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">30</span>, <span class="dv">46</span>, <span class="dv">148</span>, <span class="dv">84</span>, <span class="dv">99</span>)</span>
<span id="cb260-9"><a href="ordinal-logistic-regression.html#cb260-9"></a>ideo_cnt_dem &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">80</span>, <span class="dv">81</span>, <span class="dv">171</span>, <span class="dv">41</span>, <span class="dv">55</span>)</span>
<span id="cb260-10"><a href="ordinal-logistic-regression.html#cb260-10"></a>dat &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</span>
<span id="cb260-11"><a href="ordinal-logistic-regression.html#cb260-11"></a>  <span class="dt">party =</span> <span class="kw">factor</span>(<span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;Rep&quot;</span>, <span class="st">&quot;Dem&quot;</span>), <span class="kw">c</span>(<span class="dv">407</span>, <span class="dv">428</span>)), <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;Rep&quot;</span>, <span class="st">&quot;Dem&quot;</span>)),</span>
<span id="cb260-12"><a href="ordinal-logistic-regression.html#cb260-12"></a>  <span class="dt">ideo =</span> <span class="kw">factor</span>(</span>
<span id="cb260-13"><a href="ordinal-logistic-regression.html#cb260-13"></a>    <span class="kw">c</span>(<span class="kw">rep</span>(ideo, ideo_cnt_rep), <span class="kw">rep</span>(ideo, ideo_cnt_dem)), </span>
<span id="cb260-14"><a href="ordinal-logistic-regression.html#cb260-14"></a>    <span class="dt">levels =</span> ideo</span>
<span id="cb260-15"><a href="ordinal-logistic-regression.html#cb260-15"></a>  )</span>
<span id="cb260-16"><a href="ordinal-logistic-regression.html#cb260-16"></a>)</span>
<span id="cb260-17"><a href="ordinal-logistic-regression.html#cb260-17"></a><span class="kw">table</span>(dat)</span></code></pre></div>
<pre><code>##      ideo
## party Very Liberal Slightly Liberal Moderate Slightly Conservative
##   Rep           30               46      148                    84
##   Dem           80               81      171                    41
##      ideo
## party Very Conservative
##   Rep                99
##   Dem                55</code></pre>
<p>Fit a proportional odds model with the <code>MASS::polr()</code> function (polr stands for proportional odds linear regression).</p>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb262-1"><a href="ordinal-logistic-regression.html#cb262-1"></a>pom &lt;-<span class="st"> </span>MASS<span class="op">::</span><span class="kw">polr</span>(ideo <span class="op">~</span><span class="st"> </span>party, <span class="dt">data =</span> dat)</span>
<span id="cb262-2"><a href="ordinal-logistic-regression.html#cb262-2"></a></span>
<span id="cb262-3"><a href="ordinal-logistic-regression.html#cb262-3"></a><span class="kw">summary</span>(pom)</span></code></pre></div>
<pre><code>## 
## Re-fitting to get Hessian</code></pre>
<pre><code>## Call:
## MASS::polr(formula = ideo ~ party, data = dat)
## 
## Coefficients:
##           Value Std. Error t value
## partyDem -0.975      0.129   -7.54
## 
## Intercepts:
##                                         Value   Std. Error t value
## Very Liberal|Slightly Liberal            -2.469   0.132    -18.736
## Slightly Liberal|Moderate                -1.475   0.109    -13.531
## Moderate|Slightly Conservative            0.237   0.094      2.516
## Slightly Conservative|Very Conservative   1.070   0.104     10.292
## 
## Residual Deviance: 2474.98 
## AIC: 2484.98</code></pre>
<p>The log-odds a Democrat identifies as “Very Liberal” or lower is
<span class="math display">\[logit[P(Y \lt 1)] = -2.4690 - (-0.9745)(1) = -1.4945.\]</span>
Solve <span class="math inline">\(logit[P(Y \le 1)] = \log[P(Y \le 1) / P(Y \gt 1)]\)</span> for <span class="math inline">\(P(Y \le 1)\)</span> to get the probability a Democrat identifies as “Very Liberal” or lower as <span class="math inline">\(P(Y \le 1) = exp(-1.4945) / (1 + exp(-1.4945)) = 0.183\)</span>.</p>
<p>The log odds a Democrat identifies as “Slightly Liberal” or lower is
<span class="math display">\[logit[P(Y \lt 2)] = -1.4745 - (-0.9745)(1) = -0.5.\]</span>
The corresponding probability is <span class="math inline">\(P(Y \le 2) = exp(-0.5) / (1 + exp(-0.5)) = 0.378\)</span>.</p>
<p>To get the probability a Democrat identifies as “Slightly Liberal”, just subtract the adjacent cumulative probabilities, <span class="math inline">\(P(Y \le 2) - P(Y \le 1) = 0.378 = 0.183 = 0.194\)</span>. That’s what’s happening when you use the model to predict the level probabilities.</p>
<div class="sourceCode" id="cb265"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb265-1"><a href="ordinal-logistic-regression.html#cb265-1"></a><span class="kw">predict</span>(pom, <span class="dt">newdata =</span> <span class="kw">data.frame</span>(<span class="dt">party =</span> <span class="st">&quot;Dem&quot;</span>), <span class="dt">type =</span> <span class="st">&quot;probs&quot;</span>)</span></code></pre></div>
<pre><code>##          Very Liberal      Slightly Liberal              Moderate 
##                  0.18                  0.19                  0.39 
## Slightly Conservative     Very Conservative 
##                  0.11                  0.11</code></pre>
<p>The baseline for the model was “Republican”, so the log-odds a Republicn identifies as “Very Liberal” or lower is
<span class="math display">\[logit[P(Y \lt 1)] = -2.4690 - (-0.9745)(0) = -2.4690\]</span>
with corresponding probability <span class="math inline">\(P(Y \le 1) = exp(-2.4690) / (1 + exp(-2.4690)) = 0.078\)</span>. And so on.</p>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb267-1"><a href="ordinal-logistic-regression.html#cb267-1"></a><span class="kw">predict</span>(pom, <span class="dt">newdata =</span> <span class="kw">data.frame</span>(<span class="dt">party =</span> <span class="st">&quot;Rep&quot;</span>), <span class="dt">type =</span> <span class="st">&quot;probs&quot;</span>)</span></code></pre></div>
<pre><code>##          Very Liberal      Slightly Liberal              Moderate 
##                 0.078                 0.108                 0.373 
## Slightly Conservative     Very Conservative 
##                 0.186                 0.255</code></pre>
<p>Here is a manual calculation of the probabilities. Note the <code>zeta</code> variable instead of <code>beta</code> because the model fits <span class="math inline">\(\alpha_j - \beta X\)</span> instead of <span class="math inline">\(\alpha_j + \beta X\)</span>, and so it uses a new variable <span class="math inline">\(\zeta = -\beta\)</span>. Technically, the model could be expressed <span class="math inline">\(logit[P(Y \le j)] = \alpha_j + \zeta X\)</span>.</p>
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb269-1"><a href="ordinal-logistic-regression.html#cb269-1"></a><span class="kw">library</span>(stringr)</span>
<span id="cb269-2"><a href="ordinal-logistic-regression.html#cb269-2"></a><span class="co"># cum log odds, dems an reps</span></span>
<span id="cb269-3"><a href="ordinal-logistic-regression.html#cb269-3"></a>dclo &lt;-<span class="st"> </span><span class="kw">c</span>(pom<span class="op">$</span>zeta <span class="op">-</span><span class="st"> </span>pom<span class="op">$</span>coefficients)</span>
<span id="cb269-4"><a href="ordinal-logistic-regression.html#cb269-4"></a>rclo &lt;-<span class="st"> </span><span class="kw">c</span>(pom<span class="op">$</span>zeta <span class="op">-</span><span class="st"> </span><span class="dv">0</span>)</span>
<span id="cb269-5"><a href="ordinal-logistic-regression.html#cb269-5"></a><span class="co"># cum probs, dems and reps</span></span>
<span id="cb269-6"><a href="ordinal-logistic-regression.html#cb269-6"></a>dcp &lt;-<span class="st"> </span><span class="kw">exp</span>(dclo) <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="kw">exp</span>(dclo))</span>
<span id="cb269-7"><a href="ordinal-logistic-regression.html#cb269-7"></a>rcp &lt;-<span class="st"> </span><span class="kw">exp</span>(rclo) <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="kw">exp</span>(rclo))</span>
<span id="cb269-8"><a href="ordinal-logistic-regression.html#cb269-8"></a><span class="co"># fix the names and add 1 for &quot;Very...&quot;</span></span>
<span id="cb269-9"><a href="ordinal-logistic-regression.html#cb269-9"></a><span class="kw">names</span>(dcp) &lt;-<span class="st"> </span><span class="kw">str_sub</span>(<span class="kw">names</span>(dcp), <span class="dt">start =</span> <span class="dv">1</span>, <span class="dt">end =</span> <span class="kw">str_locate</span>(<span class="kw">names</span>(dcp), <span class="st">&quot;</span><span class="ch">\\</span><span class="st">|&quot;</span>)[, <span class="dv">1</span>] <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb269-10"><a href="ordinal-logistic-regression.html#cb269-10"></a><span class="kw">names</span>(rcp) &lt;-<span class="st"> </span><span class="kw">str_sub</span>(<span class="kw">names</span>(rcp), <span class="dt">start =</span> <span class="dv">1</span>, <span class="dt">end =</span> <span class="kw">str_locate</span>(<span class="kw">names</span>(rcp), <span class="st">&quot;</span><span class="ch">\\</span><span class="st">|&quot;</span>)[, <span class="dv">1</span>] <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb269-11"><a href="ordinal-logistic-regression.html#cb269-11"></a>dcp &lt;-<span class="st"> </span><span class="kw">c</span>(dcp, <span class="dv">1</span>)</span>
<span id="cb269-12"><a href="ordinal-logistic-regression.html#cb269-12"></a>rcp &lt;-<span class="st"> </span><span class="kw">c</span>(rcp, <span class="dv">1</span>)</span>
<span id="cb269-13"><a href="ordinal-logistic-regression.html#cb269-13"></a><span class="kw">names</span>(dcp) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">names</span>(dcp)[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>], <span class="st">&quot;Very Conservative&quot;</span>)</span>
<span id="cb269-14"><a href="ordinal-logistic-regression.html#cb269-14"></a><span class="kw">names</span>(rcp) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">names</span>(rcp)[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>], <span class="st">&quot;Very Conservative&quot;</span>)</span>
<span id="cb269-15"><a href="ordinal-logistic-regression.html#cb269-15"></a><span class="co"># Democrat probs</span></span>
<span id="cb269-16"><a href="ordinal-logistic-regression.html#cb269-16"></a>(dp &lt;-<span class="st"> </span>dcp <span class="op">-</span><span class="st"> </span><span class="kw">lag</span>(dcp, <span class="dv">1</span>, <span class="dv">0</span>))</span></code></pre></div>
<pre><code>##          Very Liberal      Slightly Liberal              Moderate 
##                  0.18                  0.19                  0.39 
## Slightly Conservative     Very Conservative 
##                  0.11                  0.11</code></pre>
<div class="sourceCode" id="cb271"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb271-1"><a href="ordinal-logistic-regression.html#cb271-1"></a>(rp &lt;-<span class="st"> </span>rcp <span class="op">-</span><span class="st"> </span><span class="kw">lag</span>(rcp, <span class="dv">1</span>, <span class="dv">0</span>))</span></code></pre></div>
<pre><code>##          Very Liberal      Slightly Liberal              Moderate 
##                 0.078                 0.108                 0.373 
## Slightly Conservative     Very Conservative 
##                 0.186                 0.255</code></pre>
<p>The “proportional odds” part of the proportional odds model is that the ratios of the <span class="math inline">\(J - 1\)</span> odds-ratios are identical for the different levels of the predictors. Here we have a single predictor, <code>party</code>. The odds ratios for <code>party = Dem</code> are</p>
<div class="sourceCode" id="cb273"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb273-1"><a href="ordinal-logistic-regression.html#cb273-1"></a>(dcp <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>dcp)) <span class="op">/</span><span class="st"> </span>(rcp <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>rcp))</span></code></pre></div>
<pre><code>##          Very Liberal      Slightly Liberal              Moderate 
##                   2.6                   2.6                   2.6 
## Slightly Conservative     Very Conservative 
##                   2.6                   NaN</code></pre>
<p>Which is to say, any level of ideology <span class="math inline">\(j\)</span>, the estimated odds that a Democrat’s ideology is more liberal <span class="math inline">\((\lt j)\)</span> rather than more conservative <span class="math inline">\((\ge j)\)</span> is about 2.65 times a Republicans odds.</p>
<p>The log of these odds ratios is the coefficient estimator for <code>party</code>.</p>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb275-1"><a href="ordinal-logistic-regression.html#cb275-1"></a><span class="kw">log</span>((dcp <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>dcp)) <span class="op">/</span><span class="st"> </span>(rcp <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>rcp)))</span></code></pre></div>
<pre><code>##          Very Liberal      Slightly Liberal              Moderate 
##                  0.97                  0.97                  0.97 
## Slightly Conservative     Very Conservative 
##                  0.97                   NaN</code></pre>
<p>Always check the assumption of proportional odds. One way to do this is by comparing the proportional odds model with a multinomial logit model, also called an unconstrained baseline logit model. The multinomial logit model models <em>unordered</em> responses and fits a slope to each level of the <span class="math inline">\(J – 1\)</span> responses. The proportional odds model is nested in the multinomial model, so can use a likelihood ratio test to see if the models are statistically different.</p>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb277-1"><a href="ordinal-logistic-regression.html#cb277-1"></a>mlm &lt;-<span class="st"> </span>nnet<span class="op">::</span><span class="kw">multinom</span>(ideo <span class="op">~</span><span class="st"> </span>party, <span class="dt">data =</span> dat)</span></code></pre></div>
<pre><code>## # weights:  15 (8 variable)
## initial  value 1343.880657 
## iter  10 value 1239.866743
## final  value 1235.648615 
## converged</code></pre>
<p>Calculate the deviance test statistic <span class="math inline">\(D = -2 loglik(\beta)\)</span>.</p>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb279-1"><a href="ordinal-logistic-regression.html#cb279-1"></a>G &lt;-<span class="st"> </span><span class="dv">-2</span> <span class="op">*</span><span class="st"> </span>(<span class="kw">logLik</span>(pom)[<span class="dv">1</span>] <span class="op">-</span><span class="st"> </span><span class="kw">logLik</span>(mlm)[<span class="dv">1</span>])</span>
<span id="cb279-2"><a href="ordinal-logistic-regression.html#cb279-2"></a><span class="kw">pchisq</span>(G, <span class="dt">df =</span> <span class="kw">length</span>(pom<span class="op">$</span>zeta) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<pre><code>## [1] 0.3</code></pre>
<p>The p-value is high, so the proportional odds model fits as well as the more complex multinomial logit model.</p>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="multinomial-logistic-regression.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="poisson-regression.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="assets/gitbook-2.6.7/js/app.min.js"></script>
<script src="assets/gitbook-2.6.7/js/lunr.js"></script>
<script src="assets/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="assets/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["data-sci.pdf", "data-sci.epub"],
"toc": {
"collapse": "subsection"
},
"toolbar": {
"position": "static"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
