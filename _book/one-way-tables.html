<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2.1 One-Way Tables | My Data Science Notes</title>
  <meta name="description" content="This is a compendium of notes from classes, tutorials, etc. that I reference from time to time." />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="2.1 One-Way Tables | My Data Science Notes" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a compendium of notes from classes, tutorials, etc. that I reference from time to time." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2.1 One-Way Tables | My Data Science Notes" />
  
  <meta name="twitter:description" content="This is a compendium of notes from classes, tutorials, etc. that I reference from time to time." />
  

<meta name="author" content="Michael Foley" />


<meta name="date" content="2020-09-04" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="contingency-tables.html"/>
<link rel="next" href="two-way-tables.html"/>
<script src="assets/jquery-2.2.3/jquery.min.js"></script>
<link href="assets/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="assets/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="assets/tabwid-1.0.0/tabwid.css" rel="stylesheet" />
<script src="assets/tabwid-1.0.0/tabwid.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">My Data Science Notes</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Intro</a></li>
<li class="chapter" data-level="1" data-path="probability.html"><a href="probability.html"><i class="fa fa-check"></i><b>1</b> Probability</a><ul>
<li class="chapter" data-level="1.1" data-path="principles.html"><a href="principles.html"><i class="fa fa-check"></i><b>1.1</b> Principles</a></li>
<li class="chapter" data-level="1.2" data-path="disc-dist.html"><a href="disc-dist.html"><i class="fa fa-check"></i><b>1.2</b> Discrete Distributions</a><ul>
<li class="chapter" data-level="1.2.1" data-path="disc-dist.html"><a href="disc-dist.html#bernoulli"><i class="fa fa-check"></i><b>1.2.1</b> Bernoulli</a></li>
<li class="chapter" data-level="1.2.2" data-path="disc-dist.html"><a href="disc-dist.html#binomial"><i class="fa fa-check"></i><b>1.2.2</b> Binomial</a></li>
<li class="chapter" data-level="1.2.3" data-path="disc-dist.html"><a href="disc-dist.html#poission"><i class="fa fa-check"></i><b>1.2.3</b> Poission</a></li>
<li class="chapter" data-level="1.2.4" data-path="disc-dist.html"><a href="disc-dist.html#multinomial"><i class="fa fa-check"></i><b>1.2.4</b> Multinomial</a></li>
<li class="chapter" data-level="1.2.5" data-path="disc-dist.html"><a href="disc-dist.html#negative-binomial"><i class="fa fa-check"></i><b>1.2.5</b> Negative-Binomial</a></li>
<li class="chapter" data-level="1.2.6" data-path="disc-dist.html"><a href="disc-dist.html#geometric"><i class="fa fa-check"></i><b>1.2.6</b> Geometric</a></li>
<li class="chapter" data-level="1.2.7" data-path="disc-dist.html"><a href="disc-dist.html#hypergeometric"><i class="fa fa-check"></i><b>1.2.7</b> Hypergeometric</a></li>
<li class="chapter" data-level="1.2.8" data-path="disc-dist.html"><a href="disc-dist.html#gamma"><i class="fa fa-check"></i><b>1.2.8</b> Gamma</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="cont-dist.html"><a href="cont-dist.html"><i class="fa fa-check"></i><b>1.3</b> Continuous Distributions</a><ul>
<li class="chapter" data-level="1.3.1" data-path="cont-dist.html"><a href="cont-dist.html#normal"><i class="fa fa-check"></i><b>1.3.1</b> Normal</a></li>
<li class="chapter" data-level="1.3.2" data-path="cont-dist.html"><a href="cont-dist.html#chi-squared"><i class="fa fa-check"></i><b>1.3.2</b> Chi-Squared</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="join-distributions.html"><a href="join-distributions.html"><i class="fa fa-check"></i><b>1.4</b> Join Distributions</a></li>
<li class="chapter" data-level="1.5" data-path="likelihood.html"><a href="likelihood.html"><i class="fa fa-check"></i><b>1.5</b> Likelihood</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="contingency-tables.html"><a href="contingency-tables.html"><i class="fa fa-check"></i><b>2</b> Contingency Tables</a><ul>
<li class="chapter" data-level="2.1" data-path="one-way-tables.html"><a href="one-way-tables.html"><i class="fa fa-check"></i><b>2.1</b> One-Way Tables</a><ul>
<li class="chapter" data-level="2.1.1" data-path="one-way-tables.html"><a href="one-way-tables.html#one-proportion-z-test"><i class="fa fa-check"></i><b>2.1.1</b> One-Proportion Z-Test</a></li>
<li class="chapter" data-level="2.1.2" data-path="one-way-tables.html"><a href="one-way-tables.html#exact-binomial-test"><i class="fa fa-check"></i><b>2.1.2</b> Exact Binomial Test</a></li>
<li class="chapter" data-level="2.1.3" data-path="one-way-tables.html"><a href="one-way-tables.html#exact-tests"><i class="fa fa-check"></i><b>2.1.3</b> Exact Tests</a></li>
<li class="chapter" data-level="2.1.4" data-path="one-way-tables.html"><a href="one-way-tables.html#chi-squared-goodness-of-fit-test"><i class="fa fa-check"></i><b>2.1.4</b> Chi-Squared Goodness-of-Fit Test</a></li>
<li class="chapter" data-level="2.1.5" data-path="one-way-tables.html"><a href="one-way-tables.html#g-test"><i class="fa fa-check"></i><b>2.1.5</b> G-Test</a></li>
<li class="chapter" data-level="2.1.6" data-path="one-way-tables.html"><a href="one-way-tables.html#fisher-exact-test"><i class="fa fa-check"></i><b>2.1.6</b> Fisher Exact Test</a></li>
<li class="chapter" data-level="2.1.7" data-path="one-way-tables.html"><a href="one-way-tables.html#special-case-proportion-test-and-exact-binomial-test"><i class="fa fa-check"></i><b>2.1.7</b> Special Case: Proportion Test and Exact Binomial Test</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="two-way-tables.html"><a href="two-way-tables.html"><i class="fa fa-check"></i><b>2.2</b> Two-Way Tables</a><ul>
<li class="chapter" data-level="2.2.1" data-path="two-way-tables.html"><a href="two-way-tables.html#proportion-difference-test"><i class="fa fa-check"></i><b>2.2.1</b> Proportion Difference Test</a></li>
<li class="chapter" data-level="2.2.2" data-path="two-way-tables.html"><a href="two-way-tables.html#chi-square-independence-test"><i class="fa fa-check"></i><b>2.2.2</b> Chi-Square Independence Test</a></li>
<li class="chapter" data-level="2.2.3" data-path="two-way-tables.html"><a href="two-way-tables.html#residuals-analysis"><i class="fa fa-check"></i><b>2.2.3</b> Residuals Analysis</a></li>
<li class="chapter" data-level="2.2.4" data-path="two-way-tables.html"><a href="two-way-tables.html#difference-in-proportions"><i class="fa fa-check"></i><b>2.2.4</b> Difference in Proportions</a></li>
<li class="chapter" data-level="2.2.5" data-path="two-way-tables.html"><a href="two-way-tables.html#relative-risk"><i class="fa fa-check"></i><b>2.2.5</b> Relative Risk</a></li>
<li class="chapter" data-level="2.2.6" data-path="two-way-tables.html"><a href="two-way-tables.html#odds-ratio"><i class="fa fa-check"></i><b>2.2.6</b> Odds Ratio</a></li>
<li class="chapter" data-level="2.2.7" data-path="two-way-tables.html"><a href="two-way-tables.html#partitioning-chi-square"><i class="fa fa-check"></i><b>2.2.7</b> Partitioning Chi-Square</a></li>
<li class="chapter" data-level="2.2.8" data-path="two-way-tables.html"><a href="two-way-tables.html#correlation"><i class="fa fa-check"></i><b>2.2.8</b> Correlation</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="k-way-tables.html"><a href="k-way-tables.html"><i class="fa fa-check"></i><b>2.3</b> K-Way Tables</a><ul>
<li class="chapter" data-level="2.3.1" data-path="k-way-tables.html"><a href="k-way-tables.html#odds-ratio-1"><i class="fa fa-check"></i><b>2.3.1</b> Odds Ratio</a></li>
<li class="chapter" data-level="2.3.2" data-path="k-way-tables.html"><a href="k-way-tables.html#chi-square-independence-test-1"><i class="fa fa-check"></i><b>2.3.2</b> Chi-Square Independence Test</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="anova-manova-ancova.html"><a href="anova-manova-ancova.html"><i class="fa fa-check"></i><b>3</b> ANOVA, MANOVA, ANCOVA</a><ul>
<li class="chapter" data-level="3.1" data-path="background.html"><a href="background.html"><i class="fa fa-check"></i><b>3.1</b> Background</a></li>
<li class="chapter" data-level="3.2" data-path="example.html"><a href="example.html"><i class="fa fa-check"></i><b>3.2</b> Example</a></li>
<li class="chapter" data-level="3.3" data-path="handling-non-constant-variance.html"><a href="handling-non-constant-variance.html"><i class="fa fa-check"></i><b>3.3</b> Handling Non-Constant Variance</a><ul>
<li class="chapter" data-level="3.3.1" data-path="handling-non-constant-variance.html"><a href="handling-non-constant-variance.html#example-1"><i class="fa fa-check"></i><b>3.3.1</b> Example</a></li>
<li class="chapter" data-level="3.3.2" data-path="handling-non-constant-variance.html"><a href="handling-non-constant-variance.html#multiple-variance-comparison-f-test"><i class="fa fa-check"></i><b>3.3.2</b> Multiple Variance Comparison F Test</a></li>
<li class="chapter" data-level="3.3.3" data-path="handling-non-constant-variance.html"><a href="handling-non-constant-variance.html#example-2"><i class="fa fa-check"></i><b>3.3.3</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>3.4</b> References</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="continuous-analysis.html"><a href="continuous-analysis.html"><i class="fa fa-check"></i><b>4</b> Continuous Variable Analysis</a><ul>
<li class="chapter" data-level="4.1" data-path="two-way-tables.html"><a href="two-way-tables.html#correlation"><i class="fa fa-check"></i><b>4.1</b> Correlation</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-2-supervised-machine-learning.html"><a href="part-2-supervised-machine-learning.html"><i class="fa fa-check"></i>PART 2: Supervised Machine Learning</a><ul>
<li class="chapter" data-level="4.2" data-path="linear-regression-model.html"><a href="linear-regression-model.html"><i class="fa fa-check"></i><b>4.2</b> Linear Regression Model</a></li>
<li class="chapter" data-level="4.3" data-path="parameter-estimation.html"><a href="parameter-estimation.html"><i class="fa fa-check"></i><b>4.3</b> Parameter Estimation</a></li>
<li class="chapter" data-level="4.4" data-path="model-assumptions.html"><a href="model-assumptions.html"><i class="fa fa-check"></i><b>4.4</b> Model Assumptions</a><ul>
<li class="chapter" data-level="4.4.1" data-path="model-assumptions.html"><a href="model-assumptions.html#linearity"><i class="fa fa-check"></i><b>4.4.1</b> Linearity</a></li>
<li class="chapter" data-level="4.4.2" data-path="model-assumptions.html"><a href="model-assumptions.html#multicollinearity"><i class="fa fa-check"></i><b>4.4.2</b> Multicollinearity</a></li>
<li class="chapter" data-level="4.4.3" data-path="model-assumptions.html"><a href="model-assumptions.html#normality"><i class="fa fa-check"></i><b>4.4.3</b> Normality</a></li>
<li class="chapter" data-level="4.4.4" data-path="model-assumptions.html"><a href="model-assumptions.html#equal-variances"><i class="fa fa-check"></i><b>4.4.4</b> Equal Variances</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="prediction.html"><a href="prediction.html"><i class="fa fa-check"></i><b>4.5</b> Prediction</a></li>
<li class="chapter" data-level="4.6" data-path="inference.html"><a href="inference.html"><i class="fa fa-check"></i><b>4.6</b> Inference</a><ul>
<li class="chapter" data-level="4.6.1" data-path="inference.html"><a href="inference.html#t-test"><i class="fa fa-check"></i><b>4.6.1</b> <em>t</em>-Test</a></li>
<li class="chapter" data-level="4.6.2" data-path="inference.html"><a href="inference.html#f-test"><i class="fa fa-check"></i><b>4.6.2</b> <em>F</em>-Test</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="interpretation.html"><a href="interpretation.html"><i class="fa fa-check"></i><b>4.7</b> Interpretation</a></li>
<li class="chapter" data-level="4.8" data-path="model-validation.html"><a href="model-validation.html"><i class="fa fa-check"></i><b>4.8</b> Model Validation</a><ul>
<li class="chapter" data-level="4.8.1" data-path="model-validation.html"><a href="model-validation.html#accuracy-metrics"><i class="fa fa-check"></i><b>4.8.1</b> Accuracy Metrics</a></li>
<li class="chapter" data-level="4.8.2" data-path="model-validation.html"><a href="model-validation.html#cross-validation"><i class="fa fa-check"></i><b>4.8.2</b> Cross-Validation</a></li>
<li class="chapter" data-level="4.8.3" data-path="model-validation.html"><a href="model-validation.html#gain-curve"><i class="fa fa-check"></i><b>4.8.3</b> Gain Curve</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="ols-reference.html"><a href="ols-reference.html"><i class="fa fa-check"></i><b>4.9</b> OLS Reference</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html"><i class="fa fa-check"></i><b>5</b> Generalized Linear Models</a><ul>
<li class="chapter" data-level="5.1" data-path="logistic-regression.html"><a href="logistic-regression.html"><i class="fa fa-check"></i><b>5.1</b> Logistic Regression</a></li>
<li class="chapter" data-level="5.2" data-path="multinomial-logistic-regression.html"><a href="multinomial-logistic-regression.html"><i class="fa fa-check"></i><b>5.2</b> Multinomial Logistic Regression</a></li>
<li class="chapter" data-level="5.3" data-path="ordinal-logistic-regression.html"><a href="ordinal-logistic-regression.html"><i class="fa fa-check"></i><b>5.3</b> Ordinal Logistic Regression</a><ul>
<li class="chapter" data-level="5.3.1" data-path="ordinal-logistic-regression.html"><a href="ordinal-logistic-regression.html#assumptions"><i class="fa fa-check"></i><b>5.3.1</b> Assumptions</a></li>
<li class="chapter" data-level="5.3.2" data-path="ordinal-logistic-regression.html"><a href="ordinal-logistic-regression.html#modeling"><i class="fa fa-check"></i><b>5.3.2</b> Modeling</a></li>
<li class="chapter" data-level="5.3.3" data-path="ordinal-logistic-regression.html"><a href="ordinal-logistic-regression.html#case-study"><i class="fa fa-check"></i><b>5.3.3</b> Case Study</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="poisson-regression.html"><a href="poisson-regression.html"><i class="fa fa-check"></i><b>5.4</b> Poisson Regression</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="multivariate-statistical-analysis.html"><a href="multivariate-statistical-analysis.html"><i class="fa fa-check"></i><b>6</b> Multivariate Statistical Analysis</a><ul>
<li class="chapter" data-level="6.1" data-path="background.html"><a href="background.html#background"><i class="fa fa-check"></i><b>6.1</b> Background</a></li>
<li class="chapter" data-level="6.2" data-path="manova.html"><a href="manova.html"><i class="fa fa-check"></i><b>6.2</b> MANOVA</a></li>
<li class="chapter" data-level="6.3" data-path="repeated-measures.html"><a href="repeated-measures.html"><i class="fa fa-check"></i><b>6.3</b> Repeated Measures</a></li>
<li class="chapter" data-level="6.4" data-path="lda.html"><a href="lda.html"><i class="fa fa-check"></i><b>6.4</b> LDA</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="regularization.html"><a href="regularization.html"><i class="fa fa-check"></i><b>7</b> Regularization</a><ul>
<li class="chapter" data-level="7.1" data-path="ridge.html"><a href="ridge.html"><i class="fa fa-check"></i><b>7.1</b> Ridge</a></li>
<li class="chapter" data-level="7.2" data-path="lasso.html"><a href="lasso.html"><i class="fa fa-check"></i><b>7.2</b> Lasso</a></li>
<li class="chapter" data-level="7.3" data-path="elastic-net.html"><a href="elastic-net.html"><i class="fa fa-check"></i><b>7.3</b> Elastic Net</a></li>
<li class="chapter" data-level="" data-path="model-summary.html"><a href="model-summary.html"><i class="fa fa-check"></i>Model Summary</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="decision-trees.html"><a href="decision-trees.html"><i class="fa fa-check"></i><b>8</b> Decision Trees</a><ul>
<li class="chapter" data-level="8.1" data-path="classification-tree.html"><a href="classification-tree.html"><i class="fa fa-check"></i><b>8.1</b> Classification Tree</a><ul>
<li class="chapter" data-level="8.1.1" data-path="classification-tree.html"><a href="classification-tree.html#measuring-performance"><i class="fa fa-check"></i><b>8.1.1</b> Measuring Performance</a></li>
<li class="chapter" data-level="8.1.2" data-path="classification-tree.html"><a href="classification-tree.html#training-with-caret"><i class="fa fa-check"></i><b>8.1.2</b> Training with Caret</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="regression-tree.html"><a href="regression-tree.html"><i class="fa fa-check"></i><b>8.2</b> Regression Tree</a><ul>
<li class="chapter" data-level="8.2.1" data-path="regression-tree.html"><a href="regression-tree.html#training-with-caret-1"><i class="fa fa-check"></i><b>8.2.1</b> Training with Caret</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="bagged-trees.html"><a href="bagged-trees.html"><i class="fa fa-check"></i><b>8.3</b> Bagged Trees</a><ul>
<li class="chapter" data-level="8.3.1" data-path="bagged-trees.html"><a href="bagged-trees.html#bagged-classification-tree"><i class="fa fa-check"></i><b>8.3.1</b> Bagged Classification Tree</a></li>
<li class="chapter" data-level="8.3.2" data-path="bagged-trees.html"><a href="bagged-trees.html#bagging-regression-tree"><i class="fa fa-check"></i><b>8.3.2</b> Bagging Regression Tree</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="random-forests.html"><a href="random-forests.html"><i class="fa fa-check"></i><b>8.4</b> Random Forests</a></li>
<li class="chapter" data-level="8.5" data-path="gradient-boosting.html"><a href="gradient-boosting.html"><i class="fa fa-check"></i><b>8.5</b> Gradient Boosting</a></li>
<li class="chapter" data-level="8.6" data-path="summary.html"><a href="summary.html"><i class="fa fa-check"></i><b>8.6</b> Summary</a><ul>
<li class="chapter" data-level="8.6.1" data-path="summary.html"><a href="summary.html#classification-trees"><i class="fa fa-check"></i><b>8.6.1</b> Classification Trees</a></li>
<li class="chapter" data-level="8.6.2" data-path="summary.html"><a href="summary.html#regression-trees"><i class="fa fa-check"></i><b>8.6.2</b> Regression Trees</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="non-linear-models.html"><a href="non-linear-models.html"><i class="fa fa-check"></i><b>9</b> Non-linear Models</a><ul>
<li class="chapter" data-level="9.1" data-path="splines.html"><a href="splines.html"><i class="fa fa-check"></i><b>9.1</b> Splines</a></li>
<li class="chapter" data-level="9.2" data-path="mars.html"><a href="mars.html"><i class="fa fa-check"></i><b>9.2</b> MARS</a></li>
<li class="chapter" data-level="9.3" data-path="gam.html"><a href="gam.html"><i class="fa fa-check"></i><b>9.3</b> GAM</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="support-vector-machines.html"><a href="support-vector-machines.html"><i class="fa fa-check"></i><b>10</b> Support Vector Machines</a><ul>
<li class="chapter" data-level="10.1" data-path="maximal-margin-classifier.html"><a href="maximal-margin-classifier.html"><i class="fa fa-check"></i><b>10.1</b> Maximal Margin Classifier</a></li>
<li class="chapter" data-level="10.2" data-path="support-vector-classifier.html"><a href="support-vector-classifier.html"><i class="fa fa-check"></i><b>10.2</b> Support Vector Classifier</a></li>
<li class="chapter" data-level="10.3" data-path="support-vector-machines-1.html"><a href="support-vector-machines-1.html"><i class="fa fa-check"></i><b>10.3</b> Support Vector Machines</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-3-unupervised-machine-learning.html"><a href="part-3-unupervised-machine-learning.html"><i class="fa fa-check"></i>PART 3: Unupervised Machine Learning</a><ul>
<li class="chapter" data-level="10.4" data-path="exploratory-factor-analysis.html"><a href="exploratory-factor-analysis.html"><i class="fa fa-check"></i><b>10.4</b> Exploratory Factor Analysis</a></li>
<li class="chapter" data-level="10.5" data-path="confirmatory-factor-analysis.html"><a href="confirmatory-factor-analysis.html"><i class="fa fa-check"></i><b>10.5</b> Confirmatory Factor Analysis</a></li>
<li class="chapter" data-level="10.6" data-path="pca.html"><a href="pca.html"><i class="fa fa-check"></i><b>10.6</b> PCA</a></li>
<li class="chapter" data-level="10.7" data-path="t-sne.html"><a href="t-sne.html"><i class="fa fa-check"></i><b>10.7</b> t-SNE</a></li>
<li class="chapter" data-level="10.8" data-path="svd.html"><a href="svd.html"><i class="fa fa-check"></i><b>10.8</b> SVD</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="cluster-analysis.html"><a href="cluster-analysis.html"><i class="fa fa-check"></i><b>11</b> Cluster Analysis</a><ul>
<li class="chapter" data-level="11.1" data-path="k-means.html"><a href="k-means.html"><i class="fa fa-check"></i><b>11.1</b> K-Means</a></li>
<li class="chapter" data-level="11.2" data-path="hca.html"><a href="hca.html"><i class="fa fa-check"></i><b>11.2</b> HCA</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="text-mining.html"><a href="text-mining.html"><i class="fa fa-check"></i><b>12</b> Text Mining</a><ul>
<li class="chapter" data-level="12.1" data-path="tidy-text.html"><a href="tidy-text.html"><i class="fa fa-check"></i><b>12.1</b> Tidy Text</a></li>
<li class="chapter" data-level="12.2" data-path="bag-of-words.html"><a href="bag-of-words.html"><i class="fa fa-check"></i><b>12.2</b> Bag of Words</a></li>
<li class="chapter" data-level="12.3" data-path="sentiment-analysis.html"><a href="sentiment-analysis.html"><i class="fa fa-check"></i><b>12.3</b> Sentiment Analysis</a><ul>
<li class="chapter" data-level="12.3.1" data-path="sentiment-analysis.html"><a href="sentiment-analysis.html#n-grams"><i class="fa fa-check"></i><b>12.3.1</b> N-Grams</a></li>
<li class="chapter" data-level="12.3.2" data-path="sentiment-analysis.html"><a href="sentiment-analysis.html#converting-to-and-from-non-tidy-formats"><i class="fa fa-check"></i><b>12.3.2</b> Converting to and from non-tidy formats</a></li>
<li class="chapter" data-level="12.3.3" data-path="example.html"><a href="example.html#example"><i class="fa fa-check"></i><b>12.3.3</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="topic-modeling.html"><a href="topic-modeling.html"><i class="fa fa-check"></i><b>12.4</b> Topic Modeling</a></li>
<li class="chapter" data-level="12.5" data-path="appendix-string-manipulation.html"><a href="appendix-string-manipulation.html"><i class="fa fa-check"></i><b>12.5</b> Appendix: String Manipulation</a><ul>
<li class="chapter" data-level="12.5.1" data-path="appendix-string-manipulation.html"><a href="appendix-string-manipulation.html#stringr-package"><i class="fa fa-check"></i><b>12.5.1</b> stringr package</a></li>
<li class="chapter" data-level="12.5.2" data-path="appendix-string-manipulation.html"><a href="appendix-string-manipulation.html#regular-expressions"><i class="fa fa-check"></i><b>12.5.2</b> Regular Expressions</a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="reference-links.html"><a href="reference-links.html"><i class="fa fa-check"></i><b>12.6</b> Reference Links</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="survival-analysis.html"><a href="survival-analysis.html"><i class="fa fa-check"></i><b>13</b> Survival Analysis</a><ul>
<li class="chapter" data-level="13.1" data-path="basic-concepts.html"><a href="basic-concepts.html"><i class="fa fa-check"></i><b>13.1</b> Basic Concepts</a></li>
<li class="chapter" data-level="13.2" data-path="survival-curve-estimation.html"><a href="survival-curve-estimation.html"><i class="fa fa-check"></i><b>13.2</b> Survival Curve Estimation</a><ul>
<li class="chapter" data-level="13.2.1" data-path="survival-curve-estimation.html"><a href="survival-curve-estimation.html#kaplan-meier"><i class="fa fa-check"></i><b>13.2.1</b> Kaplan-Meier</a></li>
<li class="chapter" data-level="13.2.2" data-path="survival-curve-estimation.html"><a href="survival-curve-estimation.html#weibull"><i class="fa fa-check"></i><b>13.2.2</b> Weibull</a></li>
<li class="chapter" data-level="13.2.3" data-path="survival-curve-estimation.html"><a href="survival-curve-estimation.html#cox"><i class="fa fa-check"></i><b>13.2.3</b> Cox</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html"><i class="fa fa-check"></i>Appendix</a><ul>
<li class="chapter" data-level="" data-path="publishing-to-bookdown.html"><a href="publishing-to-bookdown.html"><i class="fa fa-check"></i>Publishing to BookDown</a></li>
<li class="chapter" data-level="" data-path="shiny-apps.html"><a href="shiny-apps.html"><i class="fa fa-check"></i>Shiny Apps</a></li>
<li class="chapter" data-level="" data-path="packages.html"><a href="packages.html"><i class="fa fa-check"></i>Packages</a><ul>
<li class="chapter" data-level="" data-path="packages.html"><a href="packages.html#create-a-package"><i class="fa fa-check"></i>Create a package</a></li>
<li class="chapter" data-level="13.2.4" data-path="packages.html"><a href="packages.html#document-functions-with-roxygen"><i class="fa fa-check"></i><b>13.2.4</b> Document Functions with roxygen</a></li>
<li class="chapter" data-level="" data-path="packages.html"><a href="packages.html#create-data"><i class="fa fa-check"></i>Create Data</a></li>
<li class="chapter" data-level="" data-path="packages.html"><a href="packages.html#create-vignette"><i class="fa fa-check"></i>Create Vignette</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html#references"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">My Data Science Notes</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="one-way-tables" class="section level2">
<h2><span class="header-section-number">2.1</span> One-Way Tables</h2>
<p>A one-way table is a frequency table for a single categorical variable. You usually construct a one-way table to test whether the frequency counts differ from an hypothesized distribution, or to construct a confidence interval around a proportion.</p>
<p>Here is an example. A researcher crosses tall cut-leaf tomatoes with dwarf potato-leaf tomatoes, then classifies the (<em>n</em> = 1,611) offspring phenotypes. The four phenotypes are expected to occur with relative frequencies 9:3:3:1. The frequencies form a one-way table.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="one-way-tables.html#cb1-1"></a>pheno_type &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;tall cut-leaf&quot;</span>, <span class="st">&quot;tall potato-leaf&quot;</span>, <span class="st">&quot;dwarf cut-leaf&quot;</span>, <span class="st">&quot;dwarf potato-leaf&quot;</span>)</span>
<span id="cb1-2"><a href="one-way-tables.html#cb1-2"></a>pheno_obs &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">956</span>, <span class="dv">258</span>, <span class="dv">293</span>, <span class="dv">104</span>)</span>
<span id="cb1-3"><a href="one-way-tables.html#cb1-3"></a>pheno_pi &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">9</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">1</span>) <span class="op">/</span><span class="st"> </span>(<span class="dv">9</span> <span class="op">+</span><span class="st"> </span><span class="dv">3</span> <span class="op">+</span><span class="st"> </span><span class="dv">3</span> <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb1-4"><a href="one-way-tables.html#cb1-4"></a>pheno_exp &lt;-<span class="st"> </span><span class="kw">sum</span>(pheno_obs) <span class="op">*</span><span class="st"> </span>pheno_pi</span>
<span id="cb1-5"><a href="one-way-tables.html#cb1-5"></a><span class="kw">names</span>(pheno_obs) &lt;-<span class="st"> </span>pheno_type</span>
<span id="cb1-6"><a href="one-way-tables.html#cb1-6"></a><span class="kw">names</span>(pheno_exp) &lt;-<span class="st"> </span>pheno_type</span>
<span id="cb1-7"><a href="one-way-tables.html#cb1-7"></a></span>
<span id="cb1-8"><a href="one-way-tables.html#cb1-8"></a><span class="kw">data.frame</span>(<span class="dt">Phenotype =</span> pheno_type, <span class="dt">Frequency  =</span> pheno_obs) <span class="op">%&gt;%</span></span>
<span id="cb1-9"><a href="one-way-tables.html#cb1-9"></a><span class="st">  </span>flextable<span class="op">::</span><span class="kw">flextable</span>() <span class="op">%&gt;%</span></span>
<span id="cb1-10"><a href="one-way-tables.html#cb1-10"></a><span class="st">  </span>flextable<span class="op">::</span><span class="kw">autofit</span>()</span></code></pre></div>
<div class="tabwid"><table style='border-collapse:collapse;'><thead><tr style="overflow-wrap:break-word;"><td style="width:102px;background-color:transparent;vertical-align: middle;border-bottom: 2.00px solid rgba(0, 0, 0, 1.00);border-top: 2.00px solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;"><p style="margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:2px;padding-top:2px;padding-left:5px;padding-right:5px;background-color:transparent;"><span style="font-family:'Arial';font-size:11px;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(17, 17, 17, 1.00);background-color:transparent;">Phenotype</span></p></td><td style="width:73px;background-color:transparent;vertical-align: middle;border-bottom: 2.00px solid rgba(0, 0, 0, 1.00);border-top: 2.00px solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;"><p style="margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:2px;padding-top:2px;padding-left:5px;padding-right:5px;background-color:transparent;"><span style="font-family:'Arial';font-size:11px;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(17, 17, 17, 1.00);background-color:transparent;">Frequency</span></p></td></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td style="width:102px;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;"><p style="margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:2px;padding-top:2px;padding-left:5px;padding-right:5px;background-color:transparent;"><span style="font-family:'Arial';font-size:11px;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(17, 17, 17, 1.00);background-color:transparent;">tall cut-leaf</span></p></td><td style="width:73px;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;"><p style="margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:2px;padding-top:2px;padding-left:5px;padding-right:5px;background-color:transparent;"><span style="font-family:'Arial';font-size:11px;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(17, 17, 17, 1.00);background-color:transparent;">956</span></p></td></tr><tr style="overflow-wrap:break-word;"><td style="width:102px;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;"><p style="margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:2px;padding-top:2px;padding-left:5px;padding-right:5px;background-color:transparent;"><span style="font-family:'Arial';font-size:11px;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(17, 17, 17, 1.00);background-color:transparent;">tall potato-leaf</span></p></td><td style="width:73px;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;"><p style="margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:2px;padding-top:2px;padding-left:5px;padding-right:5px;background-color:transparent;"><span style="font-family:'Arial';font-size:11px;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(17, 17, 17, 1.00);background-color:transparent;">258</span></p></td></tr><tr style="overflow-wrap:break-word;"><td style="width:102px;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;"><p style="margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:2px;padding-top:2px;padding-left:5px;padding-right:5px;background-color:transparent;"><span style="font-family:'Arial';font-size:11px;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(17, 17, 17, 1.00);background-color:transparent;">dwarf cut-leaf</span></p></td><td style="width:73px;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;"><p style="margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:2px;padding-top:2px;padding-left:5px;padding-right:5px;background-color:transparent;"><span style="font-family:'Arial';font-size:11px;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(17, 17, 17, 1.00);background-color:transparent;">293</span></p></td></tr><tr style="overflow-wrap:break-word;"><td style="width:102px;background-color:transparent;vertical-align: middle;border-bottom: 2.00px solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;"><p style="margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:2px;padding-top:2px;padding-left:5px;padding-right:5px;background-color:transparent;"><span style="font-family:'Arial';font-size:11px;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(17, 17, 17, 1.00);background-color:transparent;">dwarf potato-leaf</span></p></td><td style="width:73px;background-color:transparent;vertical-align: middle;border-bottom: 2.00px solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;"><p style="margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:2px;padding-top:2px;padding-left:5px;padding-right:5px;background-color:transparent;"><span style="font-family:'Arial';font-size:11px;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(17, 17, 17, 1.00);background-color:transparent;">104</span></p></td></tr></tbody></table></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="one-way-tables.html#cb2-1"></a><span class="kw">data.frame</span>(pheno_type, pheno_obs, pheno_exp) <span class="op">%&gt;%</span></span>
<span id="cb2-2"><a href="one-way-tables.html#cb2-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> pheno_type)) <span class="op">+</span></span>
<span id="cb2-3"><a href="one-way-tables.html#cb2-3"></a><span class="st">  </span><span class="kw">geom_col</span>(<span class="kw">aes</span>(<span class="dt">y =</span> pheno_obs), <span class="dt">position =</span> <span class="kw">position_dodge</span>(), <span class="dt">fill =</span> <span class="st">&quot;#2E8BC0&quot;</span>) <span class="op">+</span></span>
<span id="cb2-4"><a href="one-way-tables.html#cb2-4"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">y =</span> pheno_exp), <span class="dt">shape =</span> <span class="st">&quot;asterisk&quot;</span>) <span class="op">+</span></span>
<span id="cb2-5"><a href="one-way-tables.html#cb2-5"></a><span class="st">  </span><span class="kw">theme_minimal</span>() <span class="op">+</span></span>
<span id="cb2-6"><a href="one-way-tables.html#cb2-6"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;top&quot;</span>) <span class="op">+</span></span>
<span id="cb2-7"><a href="one-way-tables.html#cb2-7"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Observed vs Expected (*)&quot;</span>, <span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Frequency&quot;</span>)</span></code></pre></div>
<p><img src="data-sci_files/figure-html/unnamed-chunk-2-1.png" width="480" /></p>
<p>You have a few options for analyzing one-way tables.</p>
<ul>
<li><p>If you just want to construct a confidence interval around a single level of the variable, e.g., 95% CI for the dwarf cut-leaf proportion, conduct a <strong>one-proportion z-test</strong> or an <strong>exact binomial test</strong>.</p></li>
<li><p>If you want to compare the frequency counts to an <em>expected</em> distribution, in this case 9:3:3:1, conduct an <strong>exact multinomial test</strong> (recommended for n-size &lt;= 1,000), <strong>Pearson’s chi-squared goodness-of-fit test</strong>, or <strong>G-test</strong>.</p></li>
<li><p>If your variable has more than two levels, conduct a <strong>Pearson’s chi-squared goodness-of-fit test</strong> or <strong>G-test</strong>.</p></li>
</ul>
<div id="one-proportion-z-test" class="section level3">
<h3><span class="header-section-number">2.1.1</span> One-Proportion Z-Test</h3>
<p>Conduct a one-proportion z-test to evaluate the success proportion of a binary variable, or a single level of a multinomial variable. It is also called the normal approximation method, and the Wald method.</p>
<p>The test uses the sample proportion <span class="math inline">\(p\)</span> as an estimate of the population proportion <span class="math inline">\(\pi\)</span> to evaluate an hypothesized population proportion <span class="math inline">\(\pi_0\)</span> and/or construct a <span class="math inline">\((1−\alpha)\%\)</span> confidence interval around <span class="math inline">\(p\)</span> to estimate <span class="math inline">\(\pi\)</span> within a margin of error <span class="math inline">\(\epsilon\)</span>.</p>
<p>The normal approximation method is common because it is intuitive to learn, but it only applies when the central limit theorem conditions hold:</p>
<ul>
<li>the sample is independently drawn, meaning random sampling without replacement from <span class="math inline">\(n &lt; 10\%\)</span> of the population in observational studies, or random assignment in experiments,</li>
<li>there are at least <span class="math inline">\(n\pi \ge 5\)</span> successes and <span class="math inline">\(n(1 − \pi) \ge 5\)</span> failures,</li>
<li>the sample size is <span class="math inline">\(n \ge 30\)</span>, and</li>
<li>the probability of success is not extreme, <span class="math inline">\(0.2 &lt; \pi &lt; 0.8\)</span>.</li>
</ul>
<p>If these conditions hold, the sampling distribution of <span class="math inline">\(\pi\)</span> is normally distributed around <span class="math inline">\(p\)</span> with standard error <span class="math inline">\(se_p = \frac{s_p}{\sqrt{n}} = \frac{\sqrt{p(1−p)}}{\sqrt{n}}\)</span>. The measured values <span class="math inline">\(p\)</span> and <span class="math inline">\(s_p\)</span> approximate the population values <span class="math inline">\(\pi\)</span> and <span class="math inline">\(\sigma_\pi\)</span>. You can define a <span class="math inline">\((1 − \alpha)\%\)</span> confidence interval as <span class="math inline">\(p \pm z_{\alpha / 2}se_p\)</span>. Test the hypothesis of <span class="math inline">\(\pi = \pi_0\)</span> with test statistic <span class="math inline">\(z = \frac{p − \pi_0}{se_{\pi_0}}\)</span> where <span class="math inline">\(se_{\pi_0} = \frac{s_{\pi_0}}{\sqrt{n}} = \frac{\sqrt{{\pi_0}(1−{\pi_0})}}{\sqrt{n}}\)</span>.</p>
<p>In our phenotype example above, we might want to test whether tall cut-leaf tomatoes occurred in the expected proportion, <span class="math inline">\(\pi_0 = 9 / (9 + 3 + 3 + 1) = 0.5625\)</span>. The sample is a random assignment experiment with <span class="math inline">\(956 \ge 5\)</span> successes and <span class="math inline">\(1611 - 956 = 655 \ge 5\)</span> failures, sample size <span class="math inline">\(n = 1611 \ge 30\)</span>, and probability of success <span class="math inline">\(0.2 &lt; 0.5625 &lt; 0.8\)</span>, so the z-test is valid.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="one-way-tables.html#cb3-1"></a><span class="kw">prop.test</span>(<span class="dv">956</span>, <span class="dv">1611</span>, <span class="fl">0.5625</span>, <span class="st">&quot;two.sided&quot;</span>, <span class="dt">correct =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<pre><code>## 
## 	1-sample proportions test without continuity correction
## 
## data:  956 out of 1611, null probability 0.5625
## X-squared = 6.2586, df = 1, p-value = 0.01236
## alternative hypothesis: true p is not equal to 0.5625
## 95 percent confidence interval:
##  0.5692397 0.6171563
## sample estimates:
##         p 
## 0.5934202</code></pre>
<p>The first thing you’ll notice is that <code>prop.test()</code> performs a chi-squared goodness-of-fit test, not a one-proportion z-test!</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="one-way-tables.html#cb5-1"></a><span class="kw">chisq.test</span>(<span class="kw">c</span>(<span class="dv">956</span>, <span class="dv">1611-956</span>), <span class="dt">p =</span> <span class="kw">c</span>(<span class="dv">9</span><span class="op">/</span>(<span class="dv">9</span><span class="op">+</span><span class="dv">3</span><span class="op">+</span><span class="dv">3</span><span class="op">+</span><span class="dv">1</span>), <span class="dv">7</span><span class="op">/</span>(<span class="dv">9</span><span class="op">+</span><span class="dv">3</span><span class="op">+</span><span class="dv">3</span><span class="op">+</span><span class="dv">1</span>)), <span class="dt">correct =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<pre><code>## 
## 	Chi-squared test for given probabilities
## 
## data:  c(956, 1611 - 956)
## X-squared = 6.2586, df = 1, p-value = 0.01236</code></pre>
<p>However, it turns out <span class="math inline">\(P(\chi^2 &gt; X^2)\)</span> equals <span class="math inline">\(2 \times P(Z &gt; z).\)</span> Here is the manual calculation of the chi-squared test statistic <span class="math inline">\(X^2\)</span> and resulting <em>p</em>-value on 1 dof.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="one-way-tables.html#cb7-1"></a>pi_<span class="dv">0</span> &lt;-<span class="st"> </span><span class="dv">9</span> <span class="op">/</span><span class="st"> </span>(<span class="dv">9</span><span class="op">+</span><span class="dv">3</span><span class="op">+</span><span class="dv">3</span><span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb7-2"><a href="one-way-tables.html#cb7-2"></a>p &lt;-<span class="st"> </span><span class="dv">956</span> <span class="op">/</span><span class="st"> </span><span class="dv">1611</span></span>
<span id="cb7-3"><a href="one-way-tables.html#cb7-3"></a></span>
<span id="cb7-4"><a href="one-way-tables.html#cb7-4"></a>observed &lt;-<span class="st"> </span><span class="kw">c</span>(p, <span class="dv">1</span><span class="op">-</span>p) <span class="op">*</span><span class="st"> </span><span class="dv">1611</span></span>
<span id="cb7-5"><a href="one-way-tables.html#cb7-5"></a>expected &lt;-<span class="st"> </span><span class="kw">c</span>(pi_<span class="dv">0</span>, <span class="dv">1</span><span class="op">-</span>pi_<span class="dv">0</span>) <span class="op">*</span><span class="st"> </span><span class="dv">1611</span></span>
<span id="cb7-6"><a href="one-way-tables.html#cb7-6"></a></span>
<span id="cb7-7"><a href="one-way-tables.html#cb7-7"></a>X2 &lt;-<span class="st"> </span><span class="kw">sum</span>((observed <span class="op">-</span><span class="st"> </span>expected)<span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span>expected)</span>
<span id="cb7-8"><a href="one-way-tables.html#cb7-8"></a><span class="kw">pchisq</span>(X2, <span class="dv">1</span>, <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<pre><code>## [1] 0.01235885</code></pre>
<p>And here is the manual calculation of the z-test statistic <span class="math inline">\(z\)</span> and resulting <em>p</em>-value.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="one-way-tables.html#cb9-1"></a>se &lt;-<span class="st"> </span><span class="kw">sqrt</span>(pi_<span class="dv">0</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>pi_<span class="dv">0</span>)) <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(<span class="dv">1611</span>)</span>
<span id="cb9-2"><a href="one-way-tables.html#cb9-2"></a>z &lt;-<span class="st"> </span>(p <span class="op">-</span><span class="st"> </span>pi_<span class="dv">0</span>) <span class="op">/</span><span class="st"> </span>se</span>
<span id="cb9-3"><a href="one-way-tables.html#cb9-3"></a><span class="kw">pnorm</span>(z, <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>) <span class="op">*</span><span class="st"> </span><span class="dv">2</span></span></code></pre></div>
<pre><code>## [1] 0.01235885</code></pre>
<p>The 95% CI presented by <code>prop.test()</code> is also not the <span class="math inline">\(p \pm z_{\alpha / 2}se_p\)</span> Wald interval; it is the <em>Wilson</em> interval.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="one-way-tables.html#cb11-1"></a>DescTools<span class="op">::</span><span class="kw">BinomCI</span>(<span class="dv">956</span>, <span class="dv">1611</span>, <span class="dt">method =</span> <span class="st">&quot;wilson&quot;</span>)</span></code></pre></div>
<pre><code>##            est    lwr.ci    upr.ci
## [1,] 0.5934202 0.5692397 0.6171563</code></pre>
<p>There are a lot of methods (<em>see</em> <code>?DescTools::BinomCI</code>), and <em>Wilson</em> is the one Agresti-Coull recommends and <code>prop.test()</code> presents. If you want <em>Wald</em>, use <code>DescTools::BinomCI()</code> with <code>method = "wald"</code>.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="one-way-tables.html#cb13-1"></a>DescTools<span class="op">::</span><span class="kw">BinomCI</span>(<span class="dv">956</span>, <span class="dv">1611</span>, <span class="dt">method =</span> <span class="st">&quot;wald&quot;</span>)</span></code></pre></div>
<pre><code>##            est    lwr.ci   upr.ci
## [1,] 0.5934202 0.5694344 0.617406</code></pre>
<p>This matches my manual calculation below.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="one-way-tables.html#cb15-1"></a>z_crit =<span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="fl">.05</span><span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb15-2"><a href="one-way-tables.html#cb15-2"></a>se &lt;-<span class="st"> </span><span class="kw">sqrt</span>(p<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p)) <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(<span class="dv">1611</span>)</span>
<span id="cb15-3"><a href="one-way-tables.html#cb15-3"></a></span>
<span id="cb15-4"><a href="one-way-tables.html#cb15-4"></a>(CI &lt;-<span class="st"> </span><span class="kw">c</span>(p <span class="op">-</span><span class="st"> </span>z_crit<span class="op">*</span>se, p <span class="op">+</span><span class="st"> </span>z_crit<span class="op">*</span>se))</span></code></pre></div>
<pre><code>## [1] 0.5694344 0.6174060</code></pre>
<p>The reported <em>p</em>-value is 0.01236, so you can reject the null hypothesis that <span class="math inline">\(p = 0.5625\)</span>. It’s good practice to plot this out to make sure your head is on straight.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="one-way-tables.html#cb17-1"></a>se_pi_<span class="dv">0</span> &lt;-<span class="st"> </span><span class="kw">sqrt</span>(pi_<span class="dv">0</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>pi_<span class="dv">0</span>) <span class="op">/</span><span class="st"> </span><span class="dv">1611</span>)</span>
<span id="cb17-2"><a href="one-way-tables.html#cb17-2"></a>p_value &lt;-<span class="st"> </span><span class="kw">pnorm</span>(z, <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>) <span class="op">*</span><span class="st"> </span><span class="dv">2</span></span>
<span id="cb17-3"><a href="one-way-tables.html#cb17-3"></a><span class="kw">data.frame</span>(<span class="dt">pi =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="fl">0.5</span>, <span class="dt">to =</span> <span class="fl">0.6</span>, <span class="dt">by =</span> <span class="fl">.001</span>)) <span class="op">%&gt;%</span></span>
<span id="cb17-4"><a href="one-way-tables.html#cb17-4"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">density =</span> <span class="kw">dnorm</span>(pi, pi_<span class="dv">0</span>, se_pi_<span class="dv">0</span>),</span>
<span id="cb17-5"><a href="one-way-tables.html#cb17-5"></a>         <span class="dt">q25 =</span> <span class="kw">ifelse</span>(pi <span class="op">&lt;</span><span class="st"> </span><span class="kw">qnorm</span>(<span class="dt">p =</span> <span class="fl">.025</span>, pi_<span class="dv">0</span>, se_pi_<span class="dv">0</span>), density, <span class="kw">as.numeric</span>(<span class="ot">NA</span>)),</span>
<span id="cb17-6"><a href="one-way-tables.html#cb17-6"></a>         <span class="dt">q95 =</span> <span class="kw">ifelse</span>(pi <span class="op">&gt;</span><span class="st"> </span><span class="kw">qnorm</span>(<span class="dt">p =</span> <span class="fl">.975</span>, pi_<span class="dv">0</span>, se_pi_<span class="dv">0</span>), density, <span class="kw">as.numeric</span>(<span class="ot">NA</span>))) <span class="op">%&gt;%</span></span>
<span id="cb17-7"><a href="one-way-tables.html#cb17-7"></a><span class="st">  </span><span class="kw">ggplot</span>() <span class="op">+</span></span>
<span id="cb17-8"><a href="one-way-tables.html#cb17-8"></a><span class="st">  </span><span class="kw">geom_area</span>(<span class="kw">aes</span>(<span class="dt">x =</span> pi, <span class="dt">y =</span> q25), <span class="dt">fill =</span> <span class="st">&quot;#EF7C8E&quot;</span>) <span class="op">+</span></span>
<span id="cb17-9"><a href="one-way-tables.html#cb17-9"></a><span class="st">  </span><span class="kw">geom_area</span>(<span class="kw">aes</span>(<span class="dt">x =</span> pi, <span class="dt">y =</span> q95), <span class="dt">fill =</span> <span class="st">&quot;#EF7C8E&quot;</span>) <span class="op">+</span></span>
<span id="cb17-10"><a href="one-way-tables.html#cb17-10"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">x =</span> pi, <span class="dt">y =</span> density)) <span class="op">+</span></span>
<span id="cb17-11"><a href="one-way-tables.html#cb17-11"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="kw">aes</span>(<span class="dt">xintercept =</span> p), <span class="dt">color =</span> <span class="st">&quot;#0C6980&quot;</span>, <span class="dt">size =</span> <span class="fl">1.0</span>) <span class="op">+</span></span>
<span id="cb17-12"><a href="one-way-tables.html#cb17-12"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="kw">aes</span>(<span class="dt">xintercept =</span> pi_<span class="dv">0</span>), <span class="dt">color =</span> <span class="st">&quot;#000000&quot;</span>, <span class="dt">size =</span> <span class="fl">0.5</span>, <span class="dt">linetype =</span> <span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb17-13"><a href="one-way-tables.html#cb17-13"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;One-Proportion Z-Test&quot;</span>,</span>
<span id="cb17-14"><a href="one-way-tables.html#cb17-14"></a>       <span class="dt">subtitle =</span> <span class="kw">paste0</span>(<span class="st">&quot;pi_0 = &quot;</span>, pi_<span class="dv">0</span>, <span class="st">&quot;, p = &quot;</span>, <span class="kw">round</span>(p, <span class="dv">4</span>),</span>
<span id="cb17-15"><a href="one-way-tables.html#cb17-15"></a>                         <span class="st">&quot; (p-value = &quot;</span>, <span class="kw">round</span>(p_value,<span class="dv">3</span>), <span class="st">&quot;)&quot;</span>),</span>
<span id="cb17-16"><a href="one-way-tables.html#cb17-16"></a>       <span class="dt">x =</span> <span class="st">&quot;pi&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Density&quot;</span>) <span class="op">+</span></span>
<span id="cb17-17"><a href="one-way-tables.html#cb17-17"></a><span class="st">  </span><span class="kw">theme_minimal</span>() <span class="op">+</span></span>
<span id="cb17-18"><a href="one-way-tables.html#cb17-18"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="data-sci_files/figure-html/unnamed-chunk-10-1.png" width="480" /></p>
</div>
<div id="exact-binomial-test" class="section level3">
<h3><span class="header-section-number">2.1.2</span> Exact Binomial Test</h3>
<p>The Clopper-Pearson exact binomial test is precise, but is theoretically complicated in that it inverts two single-tailed binomial tests. No formulas here - I will just rely on the software. The exact binomial method also works for small sample sizes and for extreme probabilities of success. It has only two conditions: independence, and at least <span class="math inline">\(n\pi \ge 5\)</span> successes <em>or</em> <span class="math inline">\(n(1−\pi)\ge 5\)</span> failures.</p>
<p>In the phenotype example above, we wanted to test whether tall cut-leaf tomatoes occurred in the expected proportion, <span class="math inline">\(\pi_0 = 9 / (9 + 3 + 3 + 1) = 0.5625\)</span>. The sample is a random assignment experiment with <span class="math inline">\(956 \ge 5\)</span> successes and <span class="math inline">\(1611 - 956 = 655 \ge 5\)</span> failures, so the exact binomial test is valid.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="one-way-tables.html#cb18-1"></a><span class="kw">binom.test</span>(<span class="dv">956</span>, <span class="dv">1611</span>, <span class="fl">0.5625</span>, <span class="st">&quot;two.sided&quot;</span>)</span></code></pre></div>
<pre><code>## 
## 	Exact binomial test
## 
## data:  956 and 1611
## number of successes = 956, number of trials = 1611, p-value = 0.01289
## alternative hypothesis: true probability of success is not equal to 0.5625
## 95 percent confidence interval:
##  0.5689717 0.6175276
## sample estimates:
## probability of success 
##              0.5934202</code></pre>
<p>The exact binomial test uses the “method of small <em>p</em>-values”. In this method, the probability of observing <span class="math inline">\(p\)</span> as far or further from <span class="math inline">\(\pi_0\)</span> is the sum of all <span class="math inline">\(P(X=p_i)\)</span> where <span class="math inline">\(p_i &lt;= p\)</span>.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="one-way-tables.html#cb20-1"></a>p   &lt;-<span class="st"> </span><span class="kw">dbinom</span>(<span class="dv">956</span>,    <span class="dv">1611</span>, <span class="fl">0.5625</span>)</span>
<span id="cb20-2"><a href="one-way-tables.html#cb20-2"></a>p_i &lt;-<span class="st"> </span><span class="kw">dbinom</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">1611</span>, <span class="dv">1611</span>, <span class="fl">0.5625</span>)</span>
<span id="cb20-3"><a href="one-way-tables.html#cb20-3"></a><span class="kw">map</span>(p_i, <span class="cf">function</span>(x) <span class="kw">if_else</span>(x <span class="op">&lt;=</span><span class="st"> </span>p, x, <span class="dv">0</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unlist</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">sum</span>()</span></code></pre></div>
<pre><code>## [1] 0.01289442</code></pre>
<p>You can read about the construction of the confidence interval on <a href="https://en.wikipedia.org/wiki/Binomial_proportion_confidence_interval">Wikipedia</a> and if you figure it out,</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="one-way-tables.html#cb22-1"></a><span class="kw">qbinom</span>(.<span class="dv">025</span>, <span class="dv">1611</span>, <span class="fl">0.5625</span>, <span class="dt">lower.tail =</span> <span class="ot">TRUE</span>) <span class="op">/</span><span class="st"> </span><span class="dv">1611</span></span></code></pre></div>
<pre><code>## [1] 0.538175</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="one-way-tables.html#cb24-1"></a><span class="kw">qbinom</span>(.<span class="dv">025</span>, <span class="dv">1611</span>, <span class="fl">0.5625</span>, <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>) <span class="op">/</span><span class="st"> </span><span class="dv">1611</span></span></code></pre></div>
<pre><code>## [1] 0.5865922</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="one-way-tables.html#cb26-1"></a><span class="kw">pbinom</span>(<span class="kw">qbinom</span>(.<span class="dv">025</span>, <span class="dv">1611</span>, <span class="fl">0.5625</span>, <span class="dt">lower.tail =</span> <span class="ot">TRUE</span>), <span class="dv">1611</span>, <span class="fl">0.5625</span>)</span></code></pre></div>
<pre><code>## [1] 0.02616625</code></pre>
</div>
<div id="exact-tests" class="section level3">
<h3><span class="header-section-number">2.1.3</span> Exact Tests</h3>
<p>If the sample size is small, use an exact test of goodness-of-fit to test whether the observed values of a nominal variable fit a theoretical expectation. The most common version is the exact binomial test for binomial variables, but there is also an exact multinomial test. When sample sizes are larger (&gt;=1,000), use the <em>G</em>-test or the chi-squared test of goodness-of-fit.</p>
<p>The phenotype experiment had 4 levels, but I’ll collapse it into 2 for sake of example of an exact binomial test. Suppose you crossed the two species and were only concerned with one the size (dwarf or tall) of the offspring. The expected ratio of tall:dwarf (the null hypothesis) in this example was 3:1, or 1208.25:402.75. The observed values were 1214:397 for a ratio of ~3.1:1.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="one-way-tables.html#cb28-1"></a>pheno_type2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;tall&quot;</span>, <span class="st">&quot;dwarf&quot;</span>)</span>
<span id="cb28-2"><a href="one-way-tables.html#cb28-2"></a>pheno_obs2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">sum</span>(pheno_obs[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]), <span class="kw">sum</span>(pheno_obs[<span class="dv">3</span><span class="op">:</span><span class="dv">4</span>]))</span>
<span id="cb28-3"><a href="one-way-tables.html#cb28-3"></a>pheno_pi2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>) <span class="op">/</span><span class="st"> </span>(<span class="dv">3</span> <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb28-4"><a href="one-way-tables.html#cb28-4"></a>pheno_exp2 &lt;-<span class="st"> </span><span class="kw">sum</span>(pheno_obs2) <span class="op">*</span><span class="st"> </span>pheno_pi2</span>
<span id="cb28-5"><a href="one-way-tables.html#cb28-5"></a><span class="kw">names</span>(pheno_obs2) &lt;-<span class="st"> </span>pheno_type2</span>
<span id="cb28-6"><a href="one-way-tables.html#cb28-6"></a><span class="kw">names</span>(pheno_exp2) &lt;-<span class="st"> </span>pheno_type2</span>
<span id="cb28-7"><a href="one-way-tables.html#cb28-7"></a></span>
<span id="cb28-8"><a href="one-way-tables.html#cb28-8"></a><span class="kw">data.frame</span>(pheno_type2, pheno_obs2, pheno_exp2) <span class="op">%&gt;%</span></span>
<span id="cb28-9"><a href="one-way-tables.html#cb28-9"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> pheno_type2)) <span class="op">+</span></span>
<span id="cb28-10"><a href="one-way-tables.html#cb28-10"></a><span class="st">  </span><span class="kw">geom_col</span>(<span class="kw">aes</span>(<span class="dt">y =</span> pheno_obs2), <span class="dt">position =</span> <span class="kw">position_dodge</span>(), <span class="dt">fill =</span> <span class="st">&quot;#2E8BC0&quot;</span>) <span class="op">+</span></span>
<span id="cb28-11"><a href="one-way-tables.html#cb28-11"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">y =</span> pheno_exp2), <span class="dt">shape =</span> <span class="st">&quot;asterisk&quot;</span>) <span class="op">+</span></span>
<span id="cb28-12"><a href="one-way-tables.html#cb28-12"></a><span class="st">  </span><span class="kw">theme_minimal</span>() <span class="op">+</span></span>
<span id="cb28-13"><a href="one-way-tables.html#cb28-13"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;top&quot;</span>) <span class="op">+</span></span>
<span id="cb28-14"><a href="one-way-tables.html#cb28-14"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Observed vs Expected (*)&quot;</span>, <span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Frequency&quot;</span>)</span></code></pre></div>
<p><img src="data-sci_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<p>The mixture of dwarf and tall is a binomial random variable with density function</p>
<p><span class="math display">\[f(x;n, \pi) = \frac{n!}{x!(n-x)!} \pi^x (1-\pi)^{n-x}.\]</span></p>
<p>The probability of observing <span class="math inline">\(x &gt;= 1214\)</span> <em>tall</em> offspring from a sample of <span class="math inline">\(n = 1,611\)</span> when the probability of <em>tall</em> is <span class="math inline">\(\pi = 0.75\)</span> is 0.383. The probability of observing a value this far from the expected value of 1,208 is twice that, or 0.766, so do not reject the null hypothesis that the observed values equaled the expected values.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="one-way-tables.html#cb29-1"></a><span class="co"># For lower.tail = FALSE, P(X &gt; x)</span></span>
<span id="cb29-2"><a href="one-way-tables.html#cb29-2"></a><span class="co"># For lower.tail = TRUE, P(X &lt;= x)</span></span>
<span id="cb29-3"><a href="one-way-tables.html#cb29-3"></a><span class="kw">pbinom</span>(<span class="dv">1213</span>, <span class="dv">1611</span>, <span class="fl">0.75</span>, <span class="ot">FALSE</span>) <span class="op">*</span><span class="st"> </span><span class="fl">2.0</span></span></code></pre></div>
<pre><code>## [1] 0.7659371</code></pre>
<p>Technically, you could have asked the question from the other angle: what is the probability of observing <span class="math inline">\(x &lt;= 397\)</span> <em>dwarf</em> offspring.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="one-way-tables.html#cb31-1"></a><span class="kw">pbinom</span>(<span class="dv">397</span>, <span class="dv">1611</span>, <span class="fl">0.25</span>, <span class="ot">TRUE</span>) <span class="op">*</span><span class="st"> </span><span class="fl">2.0</span></span></code></pre></div>
<pre><code>## [1] 0.7659371</code></pre>
<p>The exact binomial test is sometimes used to measure directional changes in quantitative measures in paired studies. E.g., you might measure hair density before and after a treatment. You could use a paired t–test or a Wilcoxon signed-rank test with null hypothesis that the mean or median difference between pairs of observations is zero. However, you may just be interested in direction, not magnitude.</p>
<p>[^John McDonald’s <a href="http://www.biostathandbook.com/exactgof.html">Handbook of Biological Statistics</a>], advocates for the <em>method of small p-values</em>. In this method, the probability of observing a value this far far from the expected value equals the sum of all probabilities &lt;= to the probability of the observed value.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="one-way-tables.html#cb33-1"></a>p_o &lt;-<span class="st"> </span><span class="kw">dbinom</span>(<span class="dv">956</span>, <span class="dv">1611</span>, <span class="fl">0.5625</span>)</span>
<span id="cb33-2"><a href="one-way-tables.html#cb33-2"></a>x &lt;-<span class="st"> </span><span class="kw">dbinom</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">1611</span>, <span class="dv">1611</span>, <span class="fl">0.75</span>)</span>
<span id="cb33-3"><a href="one-way-tables.html#cb33-3"></a><span class="kw">map</span>(x, <span class="cf">function</span>(x) <span class="kw">if_else</span>(x <span class="op">&lt;=</span><span class="st"> </span>p_o, x, <span class="dv">0</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unlist</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">sum</span>()</span></code></pre></div>
<pre><code>## [1] 0.01042149</code></pre>
<p>This method is essentially how the <strong>exact multinomial goodness-of-fit test</strong> works. Back to the original phenotype example with expected relative frequences 9:3:3:1</p>
</div>
<div id="chi-squared-goodness-of-fit-test" class="section level3">
<h3><span class="header-section-number">2.1.4</span> Chi-Squared Goodness-of-Fit Test</h3>
<p>The <strong>chi-squared goodness-of-fit test</strong> tests whether the observed frequency counts, <span class="math inline">\(O_j\)</span>, of the <span class="math inline">\(J\)</span> levels of a categorical variable differ from the expected frequency counts, <span class="math inline">\(E_j\)</span>. <span class="math inline">\(H_0\)</span> is <span class="math inline">\(O_j = E_j\)</span>.</p>
<p>The Pearson goodness-of-fit test statistic is</p>
<p><span class="math display">\[X^2 = \sum \frac{(O_j - E_j)^2}{E_j}\]</span></p>
<p>where <span class="math inline">\(O_j = p_j n\)</span> and <span class="math inline">\(E_j = \pi_j n\)</span>. The sampling distribution of <span class="math inline">\(X^2\)</span> approaches the <span class="math inline">\(\chi_{J-1}^2\)</span> as the sample size <span class="math inline">\(n \rightarrow \infty\)</span>. The assumption that <span class="math inline">\(X^2\)</span> is distributed <span class="math inline">\(\sim \chi^2\)</span> is not quite correct, so you will <a href="https://en.wikipedia.org/wiki/Yates%27s_correction_for_continuity">sometimes</a> see researchers subtract -.5 from the differences to increase the p-value, the so-called the Yates Continuity Correction.</p>
<p><span class="math display">\[X^2 = \sum \frac{(O_j - E_j - 0.5)^2}{E_j}\]</span></p>
<p><span class="math inline">\(X^2 \rightarrow 0\)</span> as the saturated model (the observed data represent the fit of the saturated model, the most complex model possible with the data) proportions approach the expected proportions, <span class="math inline">\(p_j \rightarrow \pi_j\)</span>. The chi-squared test calculates the probability of the occurrence of <span class="math inline">\(X^2\)</span> at least as extreme given that it is a chi-squared random variable with degrees of freedom equal to the number of levels of the variable minus one, <span class="math inline">\(J-1 = 3\)</span>. In our phenotypes example, <span class="math inline">\(X^2 = 9.55\)</span> and <span class="math inline">\(P(X^2 &gt; 9.55) = 0.0228\)</span>.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="one-way-tables.html#cb35-1"></a>pheno_dof &lt;-<span class="st"> </span><span class="kw">length</span>(pheno_type) <span class="op">-</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb35-2"><a href="one-way-tables.html#cb35-2"></a>pheno_x2 &lt;-<span class="st"> </span><span class="kw">sum</span>((pheno_obs <span class="op">-</span><span class="st"> </span>pheno_exp)<span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span>pheno_exp)</span>
<span id="cb35-3"><a href="one-way-tables.html#cb35-3"></a>pheno_p &lt;-<span class="st"> </span><span class="kw">pchisq</span>(<span class="dt">q =</span> pheno_x2, <span class="dt">df =</span> pheno_dof, <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>)</span>
<span id="cb35-4"><a href="one-way-tables.html#cb35-4"></a>pheno_p</span></code></pre></div>
<pre><code>## [1] 0.02284158</code></pre>
<p>In practice, just use the <code>chisq.test()</code> function.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="one-way-tables.html#cb37-1"></a>(pheno_chisq_test &lt;-<span class="st"> </span><span class="kw">chisq.test</span>(pheno_obs, <span class="dt">p =</span> pheno_pi, <span class="dt">correct =</span> <span class="ot">FALSE</span>))</span></code></pre></div>
<pre><code>## 
## 	Chi-squared test for given probabilities
## 
## data:  pheno_obs
## X-squared = 9.5465, df = 3, p-value = 0.02284</code></pre>
<p>The function applies the Yates continuity correction by default, so I had to specify <code>correct = FALSE</code> to exclude it. In this case, setting it to <code>TRUE</code> has almost no effect because the sample size is large.</p>
<p>The p-value based on the <span class="math inline">\(\chi^2\)</span> distribution with 3 d.f. is .023, so the test rejects the null hypothesis that the observed frequencies are consistent with expectations at the <span class="math inline">\(\alpha = 0.05\)</span> level.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="one-way-tables.html#cb39-1"></a><span class="kw">data.frame</span>(<span class="dt">chi2 =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">20</span>, <span class="dt">by =</span> <span class="fl">.1</span>)) <span class="op">%&gt;%</span></span>
<span id="cb39-2"><a href="one-way-tables.html#cb39-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">density =</span> <span class="kw">dchisq</span>(chi2, pheno_dof)) <span class="op">%&gt;%</span></span>
<span id="cb39-3"><a href="one-way-tables.html#cb39-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">q95 =</span> <span class="kw">ifelse</span>(chi2 <span class="op">&gt;</span><span class="st"> </span><span class="kw">qchisq</span>(<span class="dt">p =</span> <span class="fl">.95</span>, <span class="dt">df =</span> pheno_dof), density, <span class="kw">as.numeric</span>(<span class="ot">NA</span>))) <span class="op">%&gt;%</span></span>
<span id="cb39-4"><a href="one-way-tables.html#cb39-4"></a><span class="st">  </span><span class="kw">ggplot</span>() <span class="op">+</span></span>
<span id="cb39-5"><a href="one-way-tables.html#cb39-5"></a><span class="st">  </span><span class="kw">geom_area</span>(<span class="kw">aes</span>(<span class="dt">x =</span> chi2, <span class="dt">y =</span> q95), <span class="dt">fill =</span> <span class="st">&quot;#EF7C8E&quot;</span>) <span class="op">+</span></span>
<span id="cb39-6"><a href="one-way-tables.html#cb39-6"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">x =</span> chi2, <span class="dt">y =</span> density)) <span class="op">+</span></span>
<span id="cb39-7"><a href="one-way-tables.html#cb39-7"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="kw">aes</span>(<span class="dt">xintercept =</span> pheno_x2), <span class="dt">color =</span> <span class="st">&quot;#0C6980&quot;</span>, <span class="dt">size =</span> <span class="fl">1.0</span>) <span class="op">+</span></span>
<span id="cb39-8"><a href="one-way-tables.html#cb39-8"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Chi-Square Goodness-of-Fit Test&quot;</span>,</span>
<span id="cb39-9"><a href="one-way-tables.html#cb39-9"></a>       <span class="dt">subtitle =</span> <span class="kw">paste0</span>(<span class="st">&quot;Chi-square = &quot;</span>, <span class="kw">round</span>(pheno_x2,<span class="dv">2</span>), </span>
<span id="cb39-10"><a href="one-way-tables.html#cb39-10"></a>                         <span class="st">&quot; (p = &quot;</span>, <span class="kw">round</span>(pheno_p,<span class="dv">3</span>), <span class="st">&quot;)&quot;</span>),</span>
<span id="cb39-11"><a href="one-way-tables.html#cb39-11"></a>       <span class="dt">x =</span> <span class="st">&quot;chisq&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Density&quot;</span>) <span class="op">+</span></span>
<span id="cb39-12"><a href="one-way-tables.html#cb39-12"></a><span class="st">  </span><span class="kw">theme_minimal</span>() <span class="op">+</span></span>
<span id="cb39-13"><a href="one-way-tables.html#cb39-13"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="data-sci_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<p>If you reject <span class="math inline">\(H_0\)</span>, inspect the residuals to learn which differences contribute most to the rejection. <span class="math inline">\(X^2\)</span> is a sum of squared standardized cell differences, or “Pearson residuals”,</p>
<p><span class="math display">\[r_i = \frac{o_j - e_j}{\sqrt{e_j}}\]</span></p>
<p>Cells with the largest <span class="math inline">\(|r|\)</span> contribute the most to the total <span class="math inline">\(X^2\)</span>.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="one-way-tables.html#cb40-1"></a>pheno_chisq_test<span class="op">$</span>residuals<span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span>pheno_chisq_test<span class="op">$</span>statistic</span></code></pre></div>
<pre><code>##     tall cut-leaf  tall potato-leaf    dwarf cut-leaf dwarf potato-leaf 
##        0.28682269        0.67328098        0.02848093        0.01141540</code></pre>
<p>The two “tall” cells contributed over 95% of the <span class="math inline">\(X^2\)</span> test statistic, with the tall potato-leaf accounting for 67%. This aligns with what you’d expect from the bar plot.</p>
<p>If you want to test whether the data conform to a particular distribution instead of some set of theoretical values, the test is nearly the same except for an adjustment to the d.f. Suppose you sample <em>n</em> = 100 families and count the number of children. The count of children is a Poisson random variable, <span class="math inline">\(J \sim Pois(\lambda)\)</span> with maximum likelihood estimate <span class="math inline">\(\hat{\lambda} = \sum{j_i O_i} / \sum{O_i}\)</span>. The probabilities for each possible count are</p>
<p><span class="math display">\[f(j; \lambda) = \frac{e^{-\hat{\lambda}} \hat{\lambda}^j}{j!}.\]</span></p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="one-way-tables.html#cb42-1"></a>fam_size &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">5</span>)</span>
<span id="cb42-2"><a href="one-way-tables.html#cb42-2"></a>fam_obs &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">19</span>, <span class="dv">26</span>, <span class="dv">29</span>, <span class="dv">13</span>, <span class="dv">10</span>, <span class="dv">3</span>)</span>
<span id="cb42-3"><a href="one-way-tables.html#cb42-3"></a></span>
<span id="cb42-4"><a href="one-way-tables.html#cb42-4"></a>fam_lambda &lt;-<span class="st"> </span><span class="kw">sum</span>(fam_size <span class="op">*</span><span class="st"> </span>fam_obs) <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(fam_obs)</span>
<span id="cb42-5"><a href="one-way-tables.html#cb42-5"></a>fam_f &lt;-<span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>fam_lambda) <span class="op">*</span><span class="st"> </span>fam_lambda<span class="op">^</span>fam_size <span class="op">/</span><span class="st"> </span><span class="kw">factorial</span>(fam_size)</span>
<span id="cb42-6"><a href="one-way-tables.html#cb42-6"></a>fam_exp &lt;-<span class="st"> </span>fam_f <span class="op">*</span><span class="st"> </span><span class="kw">sum</span>(fam_obs)</span></code></pre></div>
<p>Compare the expected values to the observed values with the chi-squared goodness of fit test, but in this case, <span class="math inline">\(df = 6 - 1 - 1\)</span> because the estimated parameter <span class="math inline">\(\lambda\)</span> reduces d.f. by 1.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="one-way-tables.html#cb43-1"></a>fam_X2 &lt;-<span class="st"> </span><span class="kw">sum</span>((fam_obs <span class="op">-</span><span class="st"> </span>fam_exp)<span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span>fam_exp)</span>
<span id="cb43-2"><a href="one-way-tables.html#cb43-2"></a>fam_dof &lt;-<span class="st"> </span><span class="kw">length</span>(fam_size) <span class="op">-</span><span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="dv">1</span>  <span class="co"># subtract 1 for lambda estimation</span></span>
<span id="cb43-3"><a href="one-way-tables.html#cb43-3"></a><span class="kw">pchisq</span>(<span class="dt">q =</span> fam_X2, <span class="dt">df =</span> fam_dof)</span></code></pre></div>
<pre><code>## [1] 0.4154322</code></pre>
<p>Be careful of this adjustment to the d.f. because <code>chisq.test()</code> does not take this into account, and you cannot override the d.f.!</p>
</div>
<div id="g-test" class="section level3">
<h3><span class="header-section-number">2.1.5</span> G-Test</h3>
<p>The G-test is a likelihood-ratio statistical significance test increasingly being used instead of chi-squared tests. The test statistic is defined</p>
<p><span class="math display">\[G^2 = 2 \sum O_j \log \left[ \frac{O_j}{E_j} \right]\]</span></p>
<p>where the 2 multiplier asymptotically aligns with the chi-squared test formula. <em>G</em> is approximately a chi-squared distribution, with the same number of degrees of freedom as in the corresponding chi-squared test. In fact, the chi-squared test statistic is a second order Taylor expansion of the natural logarithm around 1.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="one-way-tables.html#cb45-1"></a>pheno_g2 &lt;-<span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="kw">sum</span>(pheno_obs <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(pheno_obs <span class="op">/</span><span class="st"> </span>pheno_exp))</span>
<span id="cb45-2"><a href="one-way-tables.html#cb45-2"></a><span class="kw">pchisq</span>(<span class="dt">q =</span> pheno_g2, <span class="dt">df =</span> pheno_dof, <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<pre><code>## [1] 0.02000552</code></pre>
<p>This is pretty close to what we got using the <span class="math inline">\(X^2\)</span> test statistic:</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="one-way-tables.html#cb47-1"></a><span class="kw">pchisq</span>(<span class="dt">q =</span> pheno_x2, <span class="dt">df =</span> pheno_dof, <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<pre><code>## [1] 0.02284158</code></pre>
<p>In practice, use the <code>DescTools::GTest()</code> function to conduct a G-test.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="one-way-tables.html#cb49-1"></a>DescTools<span class="op">::</span><span class="kw">GTest</span>(pheno_obs, <span class="dt">p =</span> pheno_pi)</span></code></pre></div>
<pre><code>## 
## 	Log likelihood ratio (G-test) goodness of fit test
## 
## data:  pheno_obs
## G = 9.8368, X-squared df = 3, p-value = 0.02001</code></pre>
<p>According to the function documentation, the G-test is not usually used for 2x2 tables.</p>
</div>
<div id="fisher-exact-test" class="section level3">
<h3><span class="header-section-number">2.1.6</span> Fisher Exact Test</h3>
<p>Fisher’s exact test is an “exact test” in that the p-value is calculated exactly from the hypergeometric distribution rather than relying on the approximation that the test statistic distribution approaches <span class="math inline">\(\chi^2\)</span> as <span class="math inline">\(n \rightarrow \infty\)</span>.</p>
<p>The test is applicable in situations where</p>
<ul>
<li>the row totals <span class="math inline">\(n_{i+}\)</span> and the column totals <span class="math inline">\(n_+j\)</span> are fixed by study design (rarely applies), and</li>
<li>the expected values of &gt;20% of cells (at least 1 cell in a 2x2 table) have expected cell counts &lt;5, and no expected cell count is &lt;1.</li>
</ul>
<p>The famous example of the Fisher exact test is the “Lady tea testing” example. A lady claims she can guess whether the milk was poured into the cup before or after the tea. The experiment consists of 8 trials, 4 of which pour the milk first, and 4 which pour the milk second. The lady guesses correctly 6 of the eight cups.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="one-way-tables.html#cb51-1"></a>tea &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">3</span>), <span class="dt">nrow =</span> <span class="dv">2</span>, </span>
<span id="cb51-2"><a href="one-way-tables.html#cb51-2"></a>       <span class="dt">dimnames =</span> <span class="kw">list</span>(<span class="dt">Guess =</span> <span class="kw">c</span>(<span class="st">&quot;Milk&quot;</span>, <span class="st">&quot;Tea&quot;</span>),</span>
<span id="cb51-3"><a href="one-way-tables.html#cb51-3"></a>                       <span class="dt">Truth =</span> <span class="kw">c</span>(<span class="st">&quot;Milk&quot;</span>, <span class="st">&quot;Tea&quot;</span>)))</span>
<span id="cb51-4"><a href="one-way-tables.html#cb51-4"></a>tibble<span class="op">::</span><span class="kw">tribble</span>(</span>
<span id="cb51-5"><a href="one-way-tables.html#cb51-5"></a>  <span class="op">~</span><span class="st">`</span><span class="dt"> </span><span class="st">`</span>, <span class="op">~</span>Men, <span class="op">~</span>Women,  <span class="op">~</span>Total,</span>
<span id="cb51-6"><a href="one-way-tables.html#cb51-6"></a>  <span class="st">&quot;Studying&quot;</span>, <span class="st">&quot;k&quot;</span>, <span class="st">&quot;K-k&quot;</span>, <span class="st">&quot;K&quot;</span>,</span>
<span id="cb51-7"><a href="one-way-tables.html#cb51-7"></a>  <span class="st">&quot;No-Studying&quot;</span>, <span class="st">&quot;n-k&quot;</span>, <span class="st">&quot;(N-K)-(n-k)&quot;</span>, <span class="st">&quot;N-K&quot;</span>,</span>
<span id="cb51-8"><a href="one-way-tables.html#cb51-8"></a>  <span class="st">&quot;Total&quot;</span>, <span class="st">&quot;n&quot;</span>, <span class="st">&quot;N-n&quot;</span>, <span class="st">&quot;N&quot;</span></span>
<span id="cb51-9"><a href="one-way-tables.html#cb51-9"></a>) <span class="op">%&gt;%</span></span>
<span id="cb51-10"><a href="one-way-tables.html#cb51-10"></a><span class="st">  </span>flextable<span class="op">::</span><span class="kw">flextable</span>() <span class="op">%&gt;%</span></span>
<span id="cb51-11"><a href="one-way-tables.html#cb51-11"></a><span class="st">  </span>flextable<span class="op">::</span><span class="kw">autofit</span>() <span class="op">%&gt;%</span></span>
<span id="cb51-12"><a href="one-way-tables.html#cb51-12"></a><span class="st">  </span>flextable<span class="op">::</span><span class="kw">bold</span>(<span class="dt">part =</span> <span class="st">&quot;header&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb51-13"><a href="one-way-tables.html#cb51-13"></a><span class="st">  </span>flextable<span class="op">::</span><span class="kw">bold</span>(<span class="dt">part =</span> <span class="st">&quot;body&quot;</span>, <span class="dt">i =</span> <span class="dv">3</span>) <span class="op">%&gt;%</span></span>
<span id="cb51-14"><a href="one-way-tables.html#cb51-14"></a><span class="st">  </span>flextable<span class="op">::</span><span class="kw">bold</span>(<span class="dt">part =</span> <span class="st">&quot;body&quot;</span>, <span class="dt">j =</span> <span class="dv">4</span>) <span class="op">%&gt;%</span></span>
<span id="cb51-15"><a href="one-way-tables.html#cb51-15"></a><span class="st">  </span>flextable<span class="op">::</span><span class="kw">add_header_row</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;&quot;</span>, <span class="st">&quot;Lady&#39;s Guess&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="st">&quot;&quot;</span>))</span></code></pre></div>
<div class="tabwid"><table style='border-collapse:collapse;'><thead><tr style="overflow-wrap:break-word;"><td style="width:81px;background-color:transparent;vertical-align: middle;border-bottom: 1.00px solid rgba(255, 255, 255, 0.00);border-top: 1.00px solid rgba(255, 255, 255, 0.00);border-left: 1.00px solid rgba(255, 255, 255, 0.00);border-right: 1.00px solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;"><p style="margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:0;padding-top:0;padding-left:0;padding-right:0;background-color:transparent;"><span style="font-family:'Arial';font-size:10px;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;"></span></p></td><td style="width:42px;background-color:transparent;vertical-align: middle;border-bottom: 1.00px solid rgba(255, 255, 255, 0.00);border-top: 1.00px solid rgba(255, 255, 255, 0.00);border-left: 1.00px solid rgba(255, 255, 255, 0.00);border-right: 1.00px solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;"><p style="margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:0;padding-top:0;padding-left:0;padding-right:0;background-color:transparent;"><span style="font-family:'Arial';font-size:10px;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;">Lady's Guess</span></p></td><td style="width:73px;background-color:transparent;vertical-align: middle;border-bottom: 1.00px solid rgba(255, 255, 255, 0.00);border-top: 1.00px solid rgba(255, 255, 255, 0.00);border-left: 1.00px solid rgba(255, 255, 255, 0.00);border-right: 1.00px solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;"><p style="margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:0;padding-top:0;padding-left:0;padding-right:0;background-color:transparent;"><span style="font-family:'Arial';font-size:10px;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;"></span></p></td><td style="width:45px;background-color:transparent;vertical-align: middle;border-bottom: 1.00px solid rgba(255, 255, 255, 0.00);border-top: 1.00px solid rgba(255, 255, 255, 0.00);border-left: 1.00px solid rgba(255, 255, 255, 0.00);border-right: 1.00px solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;"><p style="margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:0;padding-top:0;padding-left:0;padding-right:0;background-color:transparent;"><span style="font-family:'Arial';font-size:10px;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td style="width:81px;background-color:transparent;vertical-align: middle;border-bottom: 2.00px solid rgba(0, 0, 0, 1.00);border-top: 2.00px solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;"><p style="margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:2px;padding-top:2px;padding-left:5px;padding-right:5px;background-color:transparent;"><span style="font-family:'Arial';font-size:11px;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(17, 17, 17, 1.00);background-color:transparent;"> </span></p></td><td style="width:42px;background-color:transparent;vertical-align: middle;border-bottom: 2.00px solid rgba(0, 0, 0, 1.00);border-top: 2.00px solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;"><p style="margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:2px;padding-top:2px;padding-left:5px;padding-right:5px;background-color:transparent;"><span style="font-family:'Arial';font-size:11px;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(17, 17, 17, 1.00);background-color:transparent;">Men</span></p></td><td style="width:73px;background-color:transparent;vertical-align: middle;border-bottom: 2.00px solid rgba(0, 0, 0, 1.00);border-top: 2.00px solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;"><p style="margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:2px;padding-top:2px;padding-left:5px;padding-right:5px;background-color:transparent;"><span style="font-family:'Arial';font-size:11px;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(17, 17, 17, 1.00);background-color:transparent;">Women</span></p></td><td style="width:45px;background-color:transparent;vertical-align: middle;border-bottom: 2.00px solid rgba(0, 0, 0, 1.00);border-top: 2.00px solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;"><p style="margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:2px;padding-top:2px;padding-left:5px;padding-right:5px;background-color:transparent;"><span style="font-family:'Arial';font-size:11px;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(17, 17, 17, 1.00);background-color:transparent;">Total</span></p></td></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td style="width:81px;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;"><p style="margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:2px;padding-top:2px;padding-left:5px;padding-right:5px;background-color:transparent;"><span style="font-family:'Arial';font-size:11px;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(17, 17, 17, 1.00);background-color:transparent;">Studying</span></p></td><td style="width:42px;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;"><p style="margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:2px;padding-top:2px;padding-left:5px;padding-right:5px;background-color:transparent;"><span style="font-family:'Arial';font-size:11px;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(17, 17, 17, 1.00);background-color:transparent;">k</span></p></td><td style="width:73px;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;"><p style="margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:2px;padding-top:2px;padding-left:5px;padding-right:5px;background-color:transparent;"><span style="font-family:'Arial';font-size:11px;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(17, 17, 17, 1.00);background-color:transparent;">K-k</span></p></td><td style="width:45px;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;"><p style="margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:2px;padding-top:2px;padding-left:5px;padding-right:5px;background-color:transparent;"><span style="font-family:'Arial';font-size:11px;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(17, 17, 17, 1.00);background-color:transparent;">K</span></p></td></tr><tr style="overflow-wrap:break-word;"><td style="width:81px;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;"><p style="margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:2px;padding-top:2px;padding-left:5px;padding-right:5px;background-color:transparent;"><span style="font-family:'Arial';font-size:11px;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(17, 17, 17, 1.00);background-color:transparent;">No-Studying</span></p></td><td style="width:42px;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;"><p style="margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:2px;padding-top:2px;padding-left:5px;padding-right:5px;background-color:transparent;"><span style="font-family:'Arial';font-size:11px;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(17, 17, 17, 1.00);background-color:transparent;">n-k</span></p></td><td style="width:73px;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;"><p style="margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:2px;padding-top:2px;padding-left:5px;padding-right:5px;background-color:transparent;"><span style="font-family:'Arial';font-size:11px;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(17, 17, 17, 1.00);background-color:transparent;">(N-K)-(n-k)</span></p></td><td style="width:45px;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;"><p style="margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:2px;padding-top:2px;padding-left:5px;padding-right:5px;background-color:transparent;"><span style="font-family:'Arial';font-size:11px;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(17, 17, 17, 1.00);background-color:transparent;">N-K</span></p></td></tr><tr style="overflow-wrap:break-word;"><td style="width:81px;background-color:transparent;vertical-align: middle;border-bottom: 2.00px solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;"><p style="margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:2px;padding-top:2px;padding-left:5px;padding-right:5px;background-color:transparent;"><span style="font-family:'Arial';font-size:11px;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(17, 17, 17, 1.00);background-color:transparent;">Total</span></p></td><td style="width:42px;background-color:transparent;vertical-align: middle;border-bottom: 2.00px solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;"><p style="margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:2px;padding-top:2px;padding-left:5px;padding-right:5px;background-color:transparent;"><span style="font-family:'Arial';font-size:11px;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(17, 17, 17, 1.00);background-color:transparent;">n</span></p></td><td style="width:73px;background-color:transparent;vertical-align: middle;border-bottom: 2.00px solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;"><p style="margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:2px;padding-top:2px;padding-left:5px;padding-right:5px;background-color:transparent;"><span style="font-family:'Arial';font-size:11px;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(17, 17, 17, 1.00);background-color:transparent;">N-n</span></p></td><td style="width:45px;background-color:transparent;vertical-align: middle;border-bottom: 2.00px solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;"><p style="margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:2px;padding-top:2px;padding-left:5px;padding-right:5px;background-color:transparent;"><span style="font-family:'Arial';font-size:11px;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(17, 17, 17, 1.00);background-color:transparent;">N</span></p></td></tr></tbody></table></div>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="one-way-tables.html#cb52-1"></a><span class="co">#flextable::flextable(TeaTasting %&gt;% as.data.frame() %&gt;% rownames_to_column())</span></span></code></pre></div>
<p>The p-value from the test is computed as if the margins of the table are fixed. This leads under a null hypothesis of independence to a hypergeometric distribution of the numbers in the cells of the table ([Wikipedial(<a href="https://en.wikipedia.org/wiki/Fisher%27s_exact_test" class="uri">https://en.wikipedia.org/wiki/Fisher%27s_exact_test</a>)). Fisher’s exact test is useful for small <em>n</em>-size samples where the chi-squared distribution assumption of the chi-squared and G-test tests fails. Fisher’s exact test is overly conservative (p values too high) for large <em>n</em>-sizes.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="one-way-tables.html#cb53-1"></a>tibble<span class="op">::</span><span class="kw">tribble</span>(</span>
<span id="cb53-2"><a href="one-way-tables.html#cb53-2"></a>  <span class="op">~</span><span class="st">`</span><span class="dt"> </span><span class="st">`</span>, <span class="op">~</span>Men, <span class="op">~</span>Women,  <span class="op">~</span>Total,</span>
<span id="cb53-3"><a href="one-way-tables.html#cb53-3"></a>  <span class="st">&quot;Studying&quot;</span>, <span class="st">&quot;k&quot;</span>, <span class="st">&quot;K-k&quot;</span>, <span class="st">&quot;K&quot;</span>,</span>
<span id="cb53-4"><a href="one-way-tables.html#cb53-4"></a>  <span class="st">&quot;No-Studying&quot;</span>, <span class="st">&quot;n-k&quot;</span>, <span class="st">&quot;(N-K)-(n-k)&quot;</span>, <span class="st">&quot;N-K&quot;</span>,</span>
<span id="cb53-5"><a href="one-way-tables.html#cb53-5"></a>  <span class="st">&quot;Total&quot;</span>, <span class="st">&quot;n&quot;</span>, <span class="st">&quot;N-n&quot;</span>, <span class="st">&quot;N&quot;</span></span>
<span id="cb53-6"><a href="one-way-tables.html#cb53-6"></a>) <span class="op">%&gt;%</span></span>
<span id="cb53-7"><a href="one-way-tables.html#cb53-7"></a><span class="st">  </span>flextable<span class="op">::</span><span class="kw">flextable</span>() <span class="op">%&gt;%</span></span>
<span id="cb53-8"><a href="one-way-tables.html#cb53-8"></a><span class="st">  </span>flextable<span class="op">::</span><span class="kw">autofit</span>() <span class="op">%&gt;%</span></span>
<span id="cb53-9"><a href="one-way-tables.html#cb53-9"></a><span class="st">  </span>flextable<span class="op">::</span><span class="kw">bold</span>(<span class="dt">part =</span> <span class="st">&quot;header&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb53-10"><a href="one-way-tables.html#cb53-10"></a><span class="st">  </span>flextable<span class="op">::</span><span class="kw">bold</span>(<span class="dt">part =</span> <span class="st">&quot;body&quot;</span>, <span class="dt">i =</span> <span class="dv">3</span>) <span class="op">%&gt;%</span></span>
<span id="cb53-11"><a href="one-way-tables.html#cb53-11"></a><span class="st">  </span>flextable<span class="op">::</span><span class="kw">bold</span>(<span class="dt">part =</span> <span class="st">&quot;body&quot;</span>, <span class="dt">j =</span> <span class="dv">4</span>)</span></code></pre></div>
<div class="tabwid"><table style='border-collapse:collapse;'><thead><tr style="overflow-wrap:break-word;"><td style="width:81px;background-color:transparent;vertical-align: middle;border-bottom: 2.00px solid rgba(0, 0, 0, 1.00);border-top: 2.00px solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;"><p style="margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:2px;padding-top:2px;padding-left:5px;padding-right:5px;background-color:transparent;"><span style="font-family:'Arial';font-size:11px;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(17, 17, 17, 1.00);background-color:transparent;"> </span></p></td><td style="width:42px;background-color:transparent;vertical-align: middle;border-bottom: 2.00px solid rgba(0, 0, 0, 1.00);border-top: 2.00px solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;"><p style="margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:2px;padding-top:2px;padding-left:5px;padding-right:5px;background-color:transparent;"><span style="font-family:'Arial';font-size:11px;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(17, 17, 17, 1.00);background-color:transparent;">Men</span></p></td><td style="width:73px;background-color:transparent;vertical-align: middle;border-bottom: 2.00px solid rgba(0, 0, 0, 1.00);border-top: 2.00px solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;"><p style="margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:2px;padding-top:2px;padding-left:5px;padding-right:5px;background-color:transparent;"><span style="font-family:'Arial';font-size:11px;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(17, 17, 17, 1.00);background-color:transparent;">Women</span></p></td><td style="width:45px;background-color:transparent;vertical-align: middle;border-bottom: 2.00px solid rgba(0, 0, 0, 1.00);border-top: 2.00px solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;"><p style="margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:2px;padding-top:2px;padding-left:5px;padding-right:5px;background-color:transparent;"><span style="font-family:'Arial';font-size:11px;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(17, 17, 17, 1.00);background-color:transparent;">Total</span></p></td></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td style="width:81px;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;"><p style="margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:2px;padding-top:2px;padding-left:5px;padding-right:5px;background-color:transparent;"><span style="font-family:'Arial';font-size:11px;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(17, 17, 17, 1.00);background-color:transparent;">Studying</span></p></td><td style="width:42px;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;"><p style="margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:2px;padding-top:2px;padding-left:5px;padding-right:5px;background-color:transparent;"><span style="font-family:'Arial';font-size:11px;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(17, 17, 17, 1.00);background-color:transparent;">k</span></p></td><td style="width:73px;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;"><p style="margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:2px;padding-top:2px;padding-left:5px;padding-right:5px;background-color:transparent;"><span style="font-family:'Arial';font-size:11px;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(17, 17, 17, 1.00);background-color:transparent;">K-k</span></p></td><td style="width:45px;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;"><p style="margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:2px;padding-top:2px;padding-left:5px;padding-right:5px;background-color:transparent;"><span style="font-family:'Arial';font-size:11px;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(17, 17, 17, 1.00);background-color:transparent;">K</span></p></td></tr><tr style="overflow-wrap:break-word;"><td style="width:81px;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;"><p style="margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:2px;padding-top:2px;padding-left:5px;padding-right:5px;background-color:transparent;"><span style="font-family:'Arial';font-size:11px;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(17, 17, 17, 1.00);background-color:transparent;">No-Studying</span></p></td><td style="width:42px;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;"><p style="margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:2px;padding-top:2px;padding-left:5px;padding-right:5px;background-color:transparent;"><span style="font-family:'Arial';font-size:11px;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(17, 17, 17, 1.00);background-color:transparent;">n-k</span></p></td><td style="width:73px;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;"><p style="margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:2px;padding-top:2px;padding-left:5px;padding-right:5px;background-color:transparent;"><span style="font-family:'Arial';font-size:11px;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(17, 17, 17, 1.00);background-color:transparent;">(N-K)-(n-k)</span></p></td><td style="width:45px;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;"><p style="margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:2px;padding-top:2px;padding-left:5px;padding-right:5px;background-color:transparent;"><span style="font-family:'Arial';font-size:11px;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(17, 17, 17, 1.00);background-color:transparent;">N-K</span></p></td></tr><tr style="overflow-wrap:break-word;"><td style="width:81px;background-color:transparent;vertical-align: middle;border-bottom: 2.00px solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;"><p style="margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:2px;padding-top:2px;padding-left:5px;padding-right:5px;background-color:transparent;"><span style="font-family:'Arial';font-size:11px;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(17, 17, 17, 1.00);background-color:transparent;">Total</span></p></td><td style="width:42px;background-color:transparent;vertical-align: middle;border-bottom: 2.00px solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;"><p style="margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:2px;padding-top:2px;padding-left:5px;padding-right:5px;background-color:transparent;"><span style="font-family:'Arial';font-size:11px;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(17, 17, 17, 1.00);background-color:transparent;">n</span></p></td><td style="width:73px;background-color:transparent;vertical-align: middle;border-bottom: 2.00px solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;"><p style="margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:2px;padding-top:2px;padding-left:5px;padding-right:5px;background-color:transparent;"><span style="font-family:'Arial';font-size:11px;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(17, 17, 17, 1.00);background-color:transparent;">N-n</span></p></td><td style="width:45px;background-color:transparent;vertical-align: middle;border-bottom: 2.00px solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;"><p style="margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:2px;padding-top:2px;padding-left:5px;padding-right:5px;background-color:transparent;"><span style="font-family:'Arial';font-size:11px;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(17, 17, 17, 1.00);background-color:transparent;">N</span></p></td></tr></tbody></table></div>
<p>The Hypergeometric density function is
<span class="math display">\[f_X(k|N, K, n) = \frac{{{K}\choose{k}}{{N-K}\choose{n-k}}}{{N}\choose{n}}.\]</span></p>
<p>The density is the exact hypergeometric probability of observing this particular arrangement of the data, assuming the given marginal totals, on the null hypothesis that the conditional probabilities are equal.</p>
<p>The phenotype example had 4 levels, but I can collapse it into 2 for sake of example. Suppose you crossed the two species and were only concerned with one attribute: size (dwarf or tall):</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="one-way-tables.html#cb54-1"></a>pheno_obs2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">sum</span>(pheno_obs[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]), <span class="kw">sum</span>(pheno_obs[<span class="dv">3</span><span class="op">:</span><span class="dv">4</span>]))</span>
<span id="cb54-2"><a href="one-way-tables.html#cb54-2"></a>pheno_exp2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">sum</span>(pheno_exp[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]), <span class="kw">sum</span>(pheno_exp[<span class="dv">3</span><span class="op">:</span><span class="dv">4</span>]))</span>
<span id="cb54-3"><a href="one-way-tables.html#cb54-3"></a></span>
<span id="cb54-4"><a href="one-way-tables.html#cb54-4"></a><span class="kw">fisher.test</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">11</span>), <span class="kw">c</span>(<span class="dv">9</span>,<span class="dv">3</span>))</span></code></pre></div>
<pre><code>## 
## 	Fisher&#39;s Exact Test for Count Data
## 
## data:  c(1, 11) and c(9, 3)
## p-value = 1
## alternative hypothesis: true odds ratio is not equal to 1
## 95 percent confidence interval:
##   0.00000 39.00055
## sample estimates:
## odds ratio 
##          0</code></pre>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="one-way-tables.html#cb56-1"></a><span class="co">#fisher.test()</span></span></code></pre></div>
</div>
<div id="special-case-proportion-test-and-exact-binomial-test" class="section level3">
<h3><span class="header-section-number">2.1.7</span> Special Case: Proportion Test and Exact Binomial Test</h3>
<p>A special case of the one-way table is the <span class="math inline">\(2 \times 1\)</span> table for a binomial random variable. When you calculate a single proportion <span class="math inline">\(p\)</span>, you can compare it to a hypothesized <span class="math inline">\(\pi_0\)</span>, or create a confidence interval around the estimate.</p>
<p>Suppose a company claims to resolve at least 70% of maintenance requests within 24 hours. In a random sample of <span class="math inline">\(n = 50\)</span> repair requests, the company resolves <span class="math inline">\(O_1 = 33\)</span> (<span class="math inline">\(p_1 = 66\%)\)</span> within 24 hours. At a 5% level of significance, is the maintenance company’s claim valid?</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="one-way-tables.html#cb57-1"></a>o &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">33</span>, <span class="dv">17</span>)</span>
<span id="cb57-2"><a href="one-way-tables.html#cb57-2"></a>n &lt;-<span class="st"> </span><span class="kw">sum</span>(o)</span>
<span id="cb57-3"><a href="one-way-tables.html#cb57-3"></a>cell_names &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;resolved&quot;</span>, <span class="st">&quot;not resolved&quot;</span>)</span>
<span id="cb57-4"><a href="one-way-tables.html#cb57-4"></a><span class="kw">names</span>(o) &lt;-<span class="st"> </span>cell_names</span>
<span id="cb57-5"><a href="one-way-tables.html#cb57-5"></a><span class="kw">print</span>(o)</span></code></pre></div>
<pre><code>##     resolved not resolved 
##           33           17</code></pre>
<p>The null hypothesis is that the maintenance company resolves <span class="math inline">\(\pi_0 = 0.70\)</span> of requests within 24 hours, <span class="math inline">\(H_0: \pi = \pi_0\)</span> with alternative hypothesis <span class="math inline">\(H_a: \pi &lt; \pi_0\)</span>. This is a left-tailed test with an <span class="math inline">\(\alpha = 0.05\)</span> level of significance.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="one-way-tables.html#cb59-1"></a>pi_<span class="dv">0</span> &lt;-<span class="st"> </span><span class="fl">0.70</span></span>
<span id="cb59-2"><a href="one-way-tables.html#cb59-2"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.05</span></span></code></pre></div>
<p>The sample is independently drawn without replacement from &lt;10% of the population (by assumption) and there were &gt;=5 successes, so you can use the Clopper-Pearson exact binomial test. <em>Clopper-Pearson inverts two single-tailed binomial tests at the desired alpha</em>.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="one-way-tables.html#cb60-1"></a><span class="kw">binom.test</span>(<span class="dt">x =</span> o, <span class="dt">p =</span> pi_<span class="dv">0</span>, <span class="dt">alternative =</span> <span class="st">&quot;less&quot;</span>, <span class="dt">conf.level =</span> <span class="dv">1</span> <span class="op">-</span><span class="st"> </span>alpha)</span></code></pre></div>
<pre><code>## 
## 	Exact binomial test
## 
## data:  o
## number of successes = 33, number of trials = 50, p-value = 0.3161
## alternative hypothesis: true probability of success is less than 0.7
## 95 percent confidence interval:
##  0.000000 0.770452
## sample estimates:
## probability of success 
##                   0.66</code></pre>
<p>There is insufficient evidence (p = 0.3161) to reject <span class="math inline">\(H_0\)</span> that true probability of success is less than 0.7.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="one-way-tables.html#cb62-1"></a><span class="kw">library</span>(mfstylr)</span>
<span id="cb62-2"><a href="one-way-tables.html#cb62-2"></a>x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">50</span>)</span>
<span id="cb62-3"><a href="one-way-tables.html#cb62-3"></a>p_x &lt;-<span class="st"> </span><span class="kw">dbinom</span>(<span class="dt">x =</span> x, <span class="dt">size =</span> n, <span class="dt">prob =</span> pi_<span class="dv">0</span>)</span>
<span id="cb62-4"><a href="one-way-tables.html#cb62-4"></a>observed &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="kw">if_else</span>(x <span class="op">==</span><span class="st"> </span>o[<span class="dv">1</span>], <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb62-5"><a href="one-way-tables.html#cb62-5"></a><span class="kw">data.frame</span>(x, p_x, observed) <span class="op">%&gt;%</span></span>
<span id="cb62-6"><a href="one-way-tables.html#cb62-6"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> p_x, <span class="dt">fill =</span> observed)) <span class="op">+</span></span>
<span id="cb62-7"><a href="one-way-tables.html#cb62-7"></a><span class="st">  </span><span class="kw">geom_col</span>() <span class="op">+</span></span>
<span id="cb62-8"><a href="one-way-tables.html#cb62-8"></a><span class="st">  </span><span class="kw">theme_mf</span>() <span class="op">+</span></span>
<span id="cb62-9"><a href="one-way-tables.html#cb62-9"></a><span class="st">  </span><span class="kw">scale_fill_mf</span>() <span class="op">+</span></span>
<span id="cb62-10"><a href="one-way-tables.html#cb62-10"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Exact Binomial&quot;</span>)</span></code></pre></div>
<p><img src="data-sci_files/figure-html/unnamed-chunk-33-1.png" width="672" /></p>
<p>There were &gt;=5 failures, &gt;=30 observations, and the measured probability of success was within (.2,.80), so you can also use the Wald normal approximation method where <span class="math inline">\(\pi = p \pm z_{\alpha/2} SE\)</span> and <span class="math inline">\(Z = (p - \pi_0) / SE\)</span> where <span class="math inline">\(SE = \sqrt{\pi_0 (1 - \pi_0) / n}\)</span>.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="one-way-tables.html#cb63-1"></a>p &lt;-<span class="st"> </span>o[<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(o)</span>
<span id="cb63-2"><a href="one-way-tables.html#cb63-2"></a>se &lt;-<span class="st"> </span><span class="kw">sqrt</span>(pi_<span class="dv">0</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>pi_<span class="dv">0</span>) <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(o))</span>
<span id="cb63-3"><a href="one-way-tables.html#cb63-3"></a>z &lt;-<span class="st"> </span>(p <span class="op">-</span><span class="st"> </span>pi_<span class="dv">0</span>) <span class="op">/</span><span class="st"> </span>se</span>
<span id="cb63-4"><a href="one-way-tables.html#cb63-4"></a><span class="kw">pnorm</span>(<span class="dt">q =</span> p, <span class="dt">mean =</span> pi_<span class="dv">0</span>, <span class="dt">sd =</span> se, <span class="dt">lower.tail =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>## resolved 
## 0.268547</code></pre>
<p>Again, there is insufficient evidence (p = 0.2685) to reject <span class="math inline">\(H_0\)</span> that true probability of success is less than 0.7. The 95% CI around the measured p = 0.66 is</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="one-way-tables.html#cb65-1"></a>z_alpha &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="fl">0.95</span>, <span class="dt">mean =</span> p, <span class="dt">sd =</span> se, <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>)</span>
<span id="cb65-2"><a href="one-way-tables.html#cb65-2"></a><span class="kw">c</span>(<span class="dv">0</span>, p <span class="op">+</span><span class="st"> </span>z_alpha <span class="op">*</span><span class="st"> </span>se)</span></code></pre></div>
<pre><code>##            resolved 
## 0.0000000 0.6958645</code></pre>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="contingency-tables.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="two-way-tables.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="assets/gitbook-2.6.7/js/app.min.js"></script>
<script src="assets/gitbook-2.6.7/js/lunr.js"></script>
<script src="assets/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="assets/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["data-sci.pdf", "data-sci.epub"],
"toc": {
"collapse": "subsection"
},
"toolbar": {
"position": "static"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
