<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4.1 One-Way Tables | My Data Science Notes</title>
  <meta name="description" content="This is a compendium of notes from classes, tutorials, etc. that I reference from time to time." />
  <meta name="generator" content="bookdown 0.17 and GitBook 2.6.7" />

  <meta property="og:title" content="4.1 One-Way Tables | My Data Science Notes" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a compendium of notes from classes, tutorials, etc. that I reference from time to time." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4.1 One-Way Tables | My Data Science Notes" />
  
  <meta name="twitter:description" content="This is a compendium of notes from classes, tutorials, etc. that I reference from time to time." />
  

<meta name="author" content="Michael Foley" />


<meta name="date" content="2020-03-04" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="discrete-variables.html"/>
<link rel="next" href="two-way-tables.html"/>
<script src="assets/jquery-2.2.3/jquery.min.js"></script>
<link href="assets/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">My Data Science Notes</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Intro</a></li>
<li class="chapter" data-level="1" data-path="probability.html"><a href="probability.html"><i class="fa fa-check"></i><b>1</b> Probability</a><ul>
<li class="chapter" data-level="1.1" data-path="principles.html"><a href="principles.html"><i class="fa fa-check"></i><b>1.1</b> Principles</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="disc-dist.html"><a href="disc-dist.html"><i class="fa fa-check"></i><b>2</b> Discrete Distributions</a><ul>
<li class="chapter" data-level="2.1" data-path="bernoulli.html"><a href="bernoulli.html"><i class="fa fa-check"></i><b>2.1</b> Bernoulli</a></li>
<li class="chapter" data-level="2.2" data-path="binomial.html"><a href="binomial.html"><i class="fa fa-check"></i><b>2.2</b> Binomial</a></li>
<li class="chapter" data-level="2.3" data-path="poission.html"><a href="poission.html"><i class="fa fa-check"></i><b>2.3</b> Poission</a></li>
<li class="chapter" data-level="2.4" data-path="multinomial.html"><a href="multinomial.html"><i class="fa fa-check"></i><b>2.4</b> Multinomial</a></li>
<li class="chapter" data-level="2.5" data-path="negative-binomial.html"><a href="negative-binomial.html"><i class="fa fa-check"></i><b>2.5</b> Negative-Binomial</a></li>
<li class="chapter" data-level="2.6" data-path="geometric.html"><a href="geometric.html"><i class="fa fa-check"></i><b>2.6</b> Geometric</a></li>
<li class="chapter" data-level="2.7" data-path="hypergeometric.html"><a href="hypergeometric.html"><i class="fa fa-check"></i><b>2.7</b> Hypergeometric</a></li>
<li class="chapter" data-level="2.8" data-path="gamma.html"><a href="gamma.html"><i class="fa fa-check"></i><b>2.8</b> Gamma</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="cont-dist.html"><a href="cont-dist.html"><i class="fa fa-check"></i><b>3</b> Continuous Distributions</a><ul>
<li class="chapter" data-level="3.1" data-path="normal.html"><a href="normal.html"><i class="fa fa-check"></i><b>3.1</b> Normal</a><ul>
<li class="chapter" data-level="3.1.1" data-path="normal.html"><a href="normal.html#example-2"><i class="fa fa-check"></i><b>3.1.1</b> Example</a></li>
<li class="chapter" data-level="3.1.2" data-path="normal.html"><a href="normal.html#example-3"><i class="fa fa-check"></i><b>3.1.2</b> Example</a></li>
<li class="chapter" data-level="3.1.3" data-path="normal.html"><a href="normal.html#example-4"><i class="fa fa-check"></i><b>3.1.3</b> Example</a></li>
<li class="chapter" data-level="3.1.4" data-path="normal.html"><a href="normal.html#normal-approximation-to-binomial"><i class="fa fa-check"></i><b>3.1.4</b> Normal Approximation to Binomial</a></li>
<li class="chapter" data-level="3.1.5" data-path="normal.html"><a href="normal.html#example-5"><i class="fa fa-check"></i><b>3.1.5</b> Example</a></li>
<li class="chapter" data-level="3.1.6" data-path="normal.html"><a href="normal.html#example-6"><i class="fa fa-check"></i><b>3.1.6</b> Example</a></li>
<li class="chapter" data-level="3.1.7" data-path="normal.html"><a href="normal.html#from-sample-to-population"><i class="fa fa-check"></i><b>3.1.7</b> From Sample to Population</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="join-distributions.html"><a href="join-distributions.html"><i class="fa fa-check"></i><b>3.2</b> Join Distributions</a></li>
<li class="chapter" data-level="3.3" data-path="likelihood.html"><a href="likelihood.html"><i class="fa fa-check"></i><b>3.3</b> Likelihood</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="discrete-variables.html"><a href="discrete-variables.html"><i class="fa fa-check"></i><b>4</b> Discrete Variables</a><ul>
<li class="chapter" data-level="4.1" data-path="one-way-tables.html"><a href="one-way-tables.html"><i class="fa fa-check"></i><b>4.1</b> One-Way Tables</a><ul>
<li class="chapter" data-level="4.1.1" data-path="one-way-tables.html"><a href="one-way-tables.html#chi-squared-goodness-of-fit-test"><i class="fa fa-check"></i><b>4.1.1</b> Chi-Squared Goodness-of-Fit Test</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="two-way-tables.html"><a href="two-way-tables.html"><i class="fa fa-check"></i><b>4.2</b> Two-Way Tables</a><ul>
<li class="chapter" data-level="4.2.1" data-path="two-way-tables.html"><a href="two-way-tables.html#chi-squared-test-of-independence"><i class="fa fa-check"></i><b>4.2.1</b> Chi-Squared Test of Independence</a></li>
<li class="chapter" data-level="4.2.2" data-path="two-way-tables.html"><a href="two-way-tables.html#difference-in-proportions"><i class="fa fa-check"></i><b>4.2.2</b> Difference in Proportions</a></li>
<li class="chapter" data-level="4.2.3" data-path="two-way-tables.html"><a href="two-way-tables.html#relative-risk"><i class="fa fa-check"></i><b>4.2.3</b> Relative Risk</a></li>
<li class="chapter" data-level="4.2.4" data-path="two-way-tables.html"><a href="two-way-tables.html#odds-ratio"><i class="fa fa-check"></i><b>4.2.4</b> Odds Ratio</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="inference.html"><a href="inference.html"><i class="fa fa-check"></i><b>5</b> Inference</a></li>
<li class="chapter" data-level="6" data-path="regression.html"><a href="regression.html"><i class="fa fa-check"></i><b>6</b> Regression</a></li>
<li class="chapter" data-level="7" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html"><i class="fa fa-check"></i><b>7</b> Generalized Linear Models</a><ul>
<li class="chapter" data-level="7.1" data-path="logistic-regression.html"><a href="logistic-regression.html"><i class="fa fa-check"></i><b>7.1</b> Logistic Regression</a><ul>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html#example-7"><i class="fa fa-check"></i>Example</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="multinomial-logistic-regression.html"><a href="multinomial-logistic-regression.html"><i class="fa fa-check"></i><b>7.2</b> Multinomial Logistic Regression</a></li>
<li class="chapter" data-level="7.3" data-path="ordinal-logistic-regression.html"><a href="ordinal-logistic-regression.html"><i class="fa fa-check"></i><b>7.3</b> Ordinal Logistic Regression</a></li>
<li class="chapter" data-level="7.4" data-path="poisson-regression.html"><a href="poisson-regression.html"><i class="fa fa-check"></i><b>7.4</b> Poisson Regression</a><ul>
<li class="chapter" data-level="" data-path="poisson-regression.html"><a href="poisson-regression.html#example-8"><i class="fa fa-check"></i>Example</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="classification.html"><a href="classification.html"><i class="fa fa-check"></i><b>8</b> Classification</a></li>
<li class="chapter" data-level="9" data-path="classification-1.html"><a href="classification-1.html"><i class="fa fa-check"></i><b>9</b> Classification</a></li>
<li class="chapter" data-level="10" data-path="decision-trees.html"><a href="decision-trees.html"><i class="fa fa-check"></i><b>10</b> Decision Trees</a><ul>
<li class="chapter" data-level="10.1" data-path="classification-tree.html"><a href="classification-tree.html"><i class="fa fa-check"></i><b>10.1</b> Classification Tree</a><ul>
<li class="chapter" data-level="10.1.1" data-path="classification-tree.html"><a href="classification-tree.html#confusion-matrix"><i class="fa fa-check"></i><b>10.1.1</b> Confusion Matrix</a></li>
<li class="chapter" data-level="10.1.2" data-path="classification-tree.html"><a href="classification-tree.html#roc-curve"><i class="fa fa-check"></i><b>10.1.2</b> ROC Curve</a></li>
<li class="chapter" data-level="10.1.3" data-path="classification-tree.html"><a href="classification-tree.html#caret-approach"><i class="fa fa-check"></i><b>10.1.3</b> Caret Approach</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="regression-trees.html"><a href="regression-trees.html"><i class="fa fa-check"></i><b>10.2</b> Regression Trees</a><ul>
<li class="chapter" data-level="10.2.1" data-path="regression-trees.html"><a href="regression-trees.html#caret-approach-1"><i class="fa fa-check"></i><b>10.2.1</b> Caret Approach</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="bagging.html"><a href="bagging.html"><i class="fa fa-check"></i><b>10.3</b> Bagging</a></li>
<li class="chapter" data-level="10.4" data-path="random-forests.html"><a href="random-forests.html"><i class="fa fa-check"></i><b>10.4</b> Random Forests</a></li>
<li class="chapter" data-level="10.5" data-path="gradient-boosting.html"><a href="gradient-boosting.html"><i class="fa fa-check"></i><b>10.5</b> Gradient Boosting</a></li>
<li class="chapter" data-level="10.6" data-path="summary.html"><a href="summary.html"><i class="fa fa-check"></i><b>10.6</b> Summary</a></li>
<li class="chapter" data-level="10.7" data-path="reference.html"><a href="reference.html"><i class="fa fa-check"></i><b>10.7</b> Reference</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="regularization.html"><a href="regularization.html"><i class="fa fa-check"></i><b>11</b> Regularization</a></li>
<li class="chapter" data-level="12" data-path="non-linear-models.html"><a href="non-linear-models.html"><i class="fa fa-check"></i><b>12</b> Non-linear Models</a><ul>
<li class="chapter" data-level="12.1" data-path="splines.html"><a href="splines.html"><i class="fa fa-check"></i><b>12.1</b> Splines</a></li>
<li class="chapter" data-level="12.2" data-path="mars.html"><a href="mars.html"><i class="fa fa-check"></i><b>12.2</b> MARS</a></li>
<li class="chapter" data-level="12.3" data-path="gam.html"><a href="gam.html"><i class="fa fa-check"></i><b>12.3</b> GAM</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="support-vector-machines.html"><a href="support-vector-machines.html"><i class="fa fa-check"></i><b>13</b> Support Vector Machines</a><ul>
<li class="chapter" data-level="13.1" data-path="maximal-margin-classifier.html"><a href="maximal-margin-classifier.html"><i class="fa fa-check"></i><b>13.1</b> Maximal Margin Classifier</a></li>
<li class="chapter" data-level="13.2" data-path="support-vector-classifier.html"><a href="support-vector-classifier.html"><i class="fa fa-check"></i><b>13.2</b> Support Vector Classifier</a></li>
<li class="chapter" data-level="13.3" data-path="support-vector-machines-1.html"><a href="support-vector-machines-1.html"><i class="fa fa-check"></i><b>13.3</b> Support Vector Machines</a></li>
<li class="chapter" data-level="13.4" data-path="example-9.html"><a href="example-9.html"><i class="fa fa-check"></i><b>13.4</b> Example</a></li>
<li class="chapter" data-level="13.5" data-path="using-caret.html"><a href="using-caret.html"><i class="fa fa-check"></i><b>13.5</b> Using Caret</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="principal-components-analysis.html"><a href="principal-components-analysis.html"><i class="fa fa-check"></i><b>14</b> Principal Components Analysis</a></li>
<li class="chapter" data-level="15" data-path="clustering.html"><a href="clustering.html"><i class="fa fa-check"></i><b>15</b> Clustering</a></li>
<li class="chapter" data-level="16" data-path="text-mining.html"><a href="text-mining.html"><i class="fa fa-check"></i><b>16</b> Text Mining</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html"><i class="fa fa-check"></i>Appendix</a><ul>
<li class="chapter" data-level="" data-path="publishing-to-bookdown.html"><a href="publishing-to-bookdown.html"><i class="fa fa-check"></i>Publishing to BookDown</a></li>
<li class="chapter" data-level="" data-path="shiny-apps.html"><a href="shiny-apps.html"><i class="fa fa-check"></i>Shiny Apps</a></li>
<li class="chapter" data-level="" data-path="packages.html"><a href="packages.html"><i class="fa fa-check"></i>Packages</a><ul>
<li class="chapter" data-level="" data-path="packages.html"><a href="packages.html#create-a-package"><i class="fa fa-check"></i>Create a package</a></li>
<li class="chapter" data-level="16.0.1" data-path="packages.html"><a href="packages.html#document-functions-with-roxygen"><i class="fa fa-check"></i><b>16.0.1</b> Document Functions with roxygen</a></li>
<li class="chapter" data-level="" data-path="packages.html"><a href="packages.html#create-data"><i class="fa fa-check"></i>Create Data</a></li>
<li class="chapter" data-level="" data-path="packages.html"><a href="packages.html#create-vignette"><i class="fa fa-check"></i>Create Vignette</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">My Data Science Notes</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="one-way-tables" class="section level2">
<h2><span class="header-section-number">4.1</span> One-Way Tables</h2>
<p>These notes rely on PSU STATS 504 <a href="https://online.stat.psu.edu/stat504/node/60/">course notes</a>.</p>
<p>A one-way frequency table is a frequency table for a single categorical variable. You usually construct a one-way table to test whether the frequency counts differ from a hypothesized distribution using the chi-squared goodness-of-fit test.</p>
<p>Here is an example. A researcher crosses tall cut-leaf tomatoes with dwarf potato-leaf tomatoes, then classifies the (<span class="math inline">\(n = 1,611\)</span>) offspring phenotypes.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="one-way-tables.html#cb1-1"></a>o &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">926</span>, <span class="dv">288</span>, <span class="dv">293</span>, <span class="dv">104</span>)</span>
<span id="cb1-2"><a href="one-way-tables.html#cb1-2"></a>cell_names &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;tall cut-leaf&quot;</span>, <span class="st">&quot;tall potato-leaf&quot;</span>, <span class="st">&quot;dwarf cut-leaf&quot;</span>, <span class="st">&quot;dwarf potato-leaf&quot;</span>)</span>
<span id="cb1-3"><a href="one-way-tables.html#cb1-3"></a><span class="kw">names</span>(o) &lt;-<span class="st"> </span>cell_names</span>
<span id="cb1-4"><a href="one-way-tables.html#cb1-4"></a><span class="kw">print</span>(o)</span></code></pre></div>
<pre><code>##     tall cut-leaf  tall potato-leaf    dwarf cut-leaf dwarf potato-leaf 
##               926               288               293               104</code></pre>
<p>The four phenotypes are expected to occur with relative frequencies 9:3:3:1.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="one-way-tables.html#cb3-1"></a>pi &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">9</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">1</span>) <span class="op">/</span><span class="st"> </span>(<span class="dv">9</span> <span class="op">+</span><span class="st"> </span><span class="dv">3</span> <span class="op">+</span><span class="st"> </span><span class="dv">3</span> <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb3-2"><a href="one-way-tables.html#cb3-2"></a><span class="kw">print</span>(pi)</span></code></pre></div>
<pre><code>## [1] 0.5625 0.1875 0.1875 0.0625</code></pre>
<p>Do the observed phonotype counts conform to the expected proportions?</p>
<div id="chi-squared-goodness-of-fit-test" class="section level3">
<h3><span class="header-section-number">4.1.1</span> Chi-Squared Goodness-of-Fit Test</h3>
<p>The <strong>chi-squared goodness-of-fit test</strong>, tests whether observed frequency counts <span class="math inline">\(O_j\)</span> of the <span class="math inline">\(j \in (0, 1, \cdots k)\)</span> levels of a categorical variable differ from expected frequency counts <span class="math inline">\(E_j\)</span>. <span class="math inline">\(H_0\)</span> is <span class="math inline">\(O_j = E_j\)</span>.</p>
<p>There are two test statistics for this test, Pearson <span class="math inline">\(X^2\)</span> and deviance <span class="math inline">\(G^2\)</span>. The sampling distribution of each test statistic approach the chi-squared distribution as <span class="math inline">\(n\)</span> becomes large. It’s a good idea to calculate both test statistics.</p>
<p>The Pearson goodness-of-fit statistic is</p>
<p><span class="math display">\[X^2 = \sum \frac{(O_j - E_j)^2}{E_j}\]</span></p>
<p>where <span class="math inline">\(O_j = p_j n\)</span> and <span class="math inline">\(E_j = \pi_j n\)</span>. The deviance statistic is</p>
<p><span class="math display">\[G^2 = 2 \sum O_j \log \left( \frac{O_j}{E_j} \right)\]</span></p>
<p>If the saturated model (the observed data represent the fit of the saturated model, the most complex model possible with the data) proportions <span class="math inline">\(p_j\)</span> equal equal the expected proportions <span class="math inline">\(\pi_j\)</span>, <span class="math inline">\(X^2\)</span> and <span class="math inline">\(G^2\)</span> will equal zero. Large values indicate the data do not agree well with the proposed model.</p>
<p>As <span class="math inline">\(n \rightarrow \infty\)</span>, <span class="math inline">\(G^2\)</span> and <span class="math inline">\(X^2\)</span> approach <span class="math inline">\(\chi_{k-1}^2\)</span> where <span class="math inline">\(k\)</span> is the number of n-way table cells. You can therefore run a chi-square test of significance using the <span class="math inline">\(G^2\)</span> and <span class="math inline">\(X^2\)</span> test statistics. The chi-square test provides reliable results when at least 80% of <span class="math inline">\(E_j &gt;= 5\)</span>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="one-way-tables.html#cb5-1"></a>e &lt;-<span class="st"> </span><span class="kw">sum</span>(o) <span class="op">*</span><span class="st"> </span>pi</span>
<span id="cb5-2"><a href="one-way-tables.html#cb5-2"></a><span class="kw">names</span>(e) &lt;-<span class="st"> </span>cell_names</span>
<span id="cb5-3"><a href="one-way-tables.html#cb5-3"></a><span class="kw">print</span>(e)</span></code></pre></div>
<pre><code>##     tall cut-leaf  tall potato-leaf    dwarf cut-leaf dwarf potato-leaf 
##          906.1875          302.0625          302.0625          100.6875</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="one-way-tables.html#cb7-1"></a><span class="kw">data.frame</span>(o, e) <span class="op">%&gt;%</span></span>
<span id="cb7-2"><a href="one-way-tables.html#cb7-2"></a><span class="st">  </span><span class="kw">rownames_to_column</span>() <span class="op">%&gt;%</span></span>
<span id="cb7-3"><a href="one-way-tables.html#cb7-3"></a><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="op">-</span>rowname) <span class="op">%&gt;%</span></span>
<span id="cb7-4"><a href="one-way-tables.html#cb7-4"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">as.factor</span>(rowname), <span class="dt">y =</span> value, <span class="dt">fill =</span> name)) <span class="op">+</span></span>
<span id="cb7-5"><a href="one-way-tables.html#cb7-5"></a><span class="st">  </span><span class="kw">geom_col</span>(<span class="dt">position =</span> <span class="kw">position_dodge</span>()) <span class="op">+</span></span>
<span id="cb7-6"><a href="one-way-tables.html#cb7-6"></a><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label =</span> <span class="kw">round</span>(value, <span class="dv">0</span>)), <span class="dt">position =</span> <span class="kw">position_dodge</span>(<span class="dt">width =</span> <span class="fl">0.9</span>)) <span class="op">+</span></span>
<span id="cb7-7"><a href="one-way-tables.html#cb7-7"></a><span class="st">  </span><span class="kw">theme_mf</span>() <span class="op">+</span></span>
<span id="cb7-8"><a href="one-way-tables.html#cb7-8"></a><span class="st">  </span><span class="kw">scale_fill_mf</span>() <span class="op">+</span></span>
<span id="cb7-9"><a href="one-way-tables.html#cb7-9"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Observed vs Expected&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;&quot;</span>, <span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p><img src="data-sci_files/figure-html/unnamed-chunk-5-1.png" width="576" /></p>
<p>The <span class="math inline">\(X^2\)</span> statistic is <code>x2 &lt;- sum((o - e)^2 / e) =</code> 1.468722 and the <span class="math inline">\(G^2\)</span> statistic is <code>g2 &lt;- 2 * sum(o * log(o / e)) =</code> 1.4775868, so nearly identical. The chi-sq test p-values are also nearly identical.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="one-way-tables.html#cb8-1"></a><span class="kw">pchisq</span>(<span class="dt">q =</span> x2, <span class="dt">df =</span> <span class="kw">length</span>(o) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<pre><code>## [1] 0.6895079</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="one-way-tables.html#cb10-1"></a><span class="kw">pchisq</span>(<span class="dt">q =</span> g2, <span class="dt">df =</span> <span class="kw">length</span>(o) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<pre><code>## [1] 0.6874529</code></pre>
<p>You can also perform the chi-square test of the Pearson test statistic with <code>chisq.test()</code>.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="one-way-tables.html#cb12-1"></a><span class="kw">chisq.test</span>(o, <span class="dt">p =</span> pi)</span></code></pre></div>
<pre><code>## 
##  Chi-squared test for given probabilities
## 
## data:  o
## X-squared = 1.4687, df = 3, p-value = 0.6895</code></pre>
<p>The p-values based on the <span class="math inline">\(\chi^2\)</span> distribution with 3 d.f. are about 0.69, so we fail to reject the null hypothesis - the data are consistent with the genetic theory. The <span class="math inline">\(\chi^2\)</span> value is well outside the <span class="math inline">\(\alpha = 0.05\)</span> level range of regression.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="one-way-tables.html#cb14-1"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.05</span></span>
<span id="cb14-2"><a href="one-way-tables.html#cb14-2"></a>dof &lt;-<span class="st"> </span><span class="kw">length</span>(e) <span class="op">-</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb14-3"><a href="one-way-tables.html#cb14-3"></a>lrr =<span class="st"> </span><span class="op">-</span><span class="ot">Inf</span></span>
<span id="cb14-4"><a href="one-way-tables.html#cb14-4"></a>p_val &lt;-<span class="st"> </span><span class="kw">pchisq</span>(<span class="dt">q =</span> x2, <span class="dt">df =</span> <span class="kw">length</span>(o) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>)</span>
<span id="cb14-5"><a href="one-way-tables.html#cb14-5"></a>urr =<span class="st"> </span><span class="kw">qchisq</span>(<span class="dt">p =</span> alpha, <span class="dt">df =</span> dof, <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>)</span>
<span id="cb14-6"><a href="one-way-tables.html#cb14-6"></a> <span class="kw">data.frame</span>(<span class="dt">chi2 =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">20</span>, <span class="dt">by =</span> <span class="fl">.1</span>)) <span class="op">%&gt;%</span></span>
<span id="cb14-7"><a href="one-way-tables.html#cb14-7"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">density =</span> <span class="kw">dchisq</span>(<span class="dt">x =</span> chi2, <span class="dt">df =</span> dof)) <span class="op">%&gt;%</span></span>
<span id="cb14-8"><a href="one-way-tables.html#cb14-8"></a><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">rr =</span> <span class="kw">ifelse</span>(chi2 <span class="op">&lt;</span><span class="st"> </span>lrr <span class="op">|</span><span class="st"> </span>chi2 <span class="op">&gt;</span><span class="st"> </span>urr, density, <span class="dv">0</span>)) <span class="op">%&gt;%</span></span>
<span id="cb14-9"><a href="one-way-tables.html#cb14-9"></a><span class="st"> </span><span class="kw">ggplot</span>() <span class="op">+</span></span>
<span id="cb14-10"><a href="one-way-tables.html#cb14-10"></a><span class="st">   </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">x =</span> chi2, <span class="dt">y =</span> density), <span class="dt">color =</span> <span class="kw">mf_pal</span>(<span class="dv">12</span>)(<span class="dv">12</span>)[<span class="dv">12</span>], <span class="dt">size =</span> <span class="fl">0.8</span>) <span class="op">+</span></span>
<span id="cb14-11"><a href="one-way-tables.html#cb14-11"></a><span class="st">   </span><span class="kw">geom_area</span>(<span class="kw">aes</span>(<span class="dt">x =</span> chi2, <span class="dt">y =</span> rr), <span class="dt">fill =</span> <span class="kw">mf_pal</span>(<span class="dv">12</span>)(<span class="dv">12</span>)[<span class="dv">2</span>], <span class="dt">alpha =</span> <span class="fl">0.8</span>) <span class="op">+</span></span>
<span id="cb14-12"><a href="one-way-tables.html#cb14-12"></a><span class="st">   </span><span class="kw">geom_vline</span>(<span class="kw">aes</span>(<span class="dt">xintercept =</span> x2), <span class="dt">color =</span> <span class="kw">mf_pal</span>(<span class="dv">12</span>)(<span class="dv">12</span>)[<span class="dv">11</span>], <span class="dt">size =</span> <span class="fl">0.8</span>) <span class="op">+</span></span>
<span id="cb14-13"><a href="one-way-tables.html#cb14-13"></a><span class="st">   </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="kw">bquote</span>(<span class="st">&quot;Chi-Squared Goodness-of-Fit Test&quot;</span>),</span>
<span id="cb14-14"><a href="one-way-tables.html#cb14-14"></a>        <span class="dt">subtitle =</span> <span class="kw">paste0</span>(<span class="st">&quot;Chisq=&quot;</span>, <span class="kw">round</span>(x2,<span class="dv">2</span>), <span class="st">&quot;, &quot;</span>,</span>
<span id="cb14-15"><a href="one-way-tables.html#cb14-15"></a>                          <span class="st">&quot;Critical value=&quot;</span>, <span class="kw">round</span>(urr,<span class="dv">2</span>), <span class="st">&quot;, &quot;</span>,</span>
<span id="cb14-16"><a href="one-way-tables.html#cb14-16"></a>                          <span class="st">&quot;p-value=&quot;</span>, <span class="kw">round</span>(p_val,<span class="dv">3</span>), <span class="st">&quot;.&quot;</span></span>
<span id="cb14-17"><a href="one-way-tables.html#cb14-17"></a>                          ),</span>
<span id="cb14-18"><a href="one-way-tables.html#cb14-18"></a>        <span class="dt">x =</span> <span class="st">&quot;chisq&quot;</span>,</span>
<span id="cb14-19"><a href="one-way-tables.html#cb14-19"></a>        <span class="dt">y =</span> <span class="st">&quot;Density&quot;</span>) <span class="op">+</span></span>
<span id="cb14-20"><a href="one-way-tables.html#cb14-20"></a><span class="st">   </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;none&quot;</span>) <span class="op">+</span></span>
<span id="cb14-21"><a href="one-way-tables.html#cb14-21"></a><span class="st">   </span><span class="kw">theme_mf</span>()</span></code></pre></div>
<p><img src="data-sci_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>Inspect the residuals to learn which differences may lead to rejecting the null hypothesis. The Pearson and deviance statistics are sums of individual cell comparisons which can be termed the squared “residuals”, <span class="math inline">\(X^2 = \sum r_j^2\)</span> and <span class="math inline">\(G^2 = \sum G_j^2\)</span>. The expected value of a <span class="math inline">\(\chi^2\)</span> random variable is its d.f., <span class="math inline">\(k-1\)</span>, and the typical size of any <span class="math inline">\(\chi^2\)</span> value is be <span class="math inline">\((k - 1) / k\)</span>, so for the typical residual should be within 2 <span class="math inline">\(\sqrt{(k - 1) / k}\)</span>.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="one-way-tables.html#cb15-1"></a>e2_res &lt;-<span class="st"> </span><span class="kw">sqrt</span>((o <span class="op">-</span><span class="st"> </span>e)<span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span>e)</span>
<span id="cb15-2"><a href="one-way-tables.html#cb15-2"></a>g2_res &lt;-<span class="st"> </span><span class="kw">sign</span>(o <span class="op">-</span><span class="st"> </span>e) <span class="op">*</span><span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">abs</span>(<span class="dv">2</span> <span class="op">*</span><span class="st"> </span>o <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(o <span class="op">/</span><span class="st"> </span>e)))</span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="one-way-tables.html#cb16-1"></a><span class="kw">data.frame</span>(e2_res, g2_res, <span class="dt">obs =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(e2_res)) <span class="op">%&gt;%</span></span>
<span id="cb16-2"><a href="one-way-tables.html#cb16-2"></a><span class="st">  </span><span class="kw">rownames_to_column</span>() <span class="op">%&gt;%</span></span>
<span id="cb16-3"><a href="one-way-tables.html#cb16-3"></a><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> e2_res<span class="op">:</span>g2_res) <span class="op">%&gt;%</span></span>
<span id="cb16-4"><a href="one-way-tables.html#cb16-4"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> obs, <span class="dt">y =</span> value, <span class="dt">color =</span> name)) <span class="op">+</span></span>
<span id="cb16-5"><a href="one-way-tables.html#cb16-5"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb16-6"><a href="one-way-tables.html#cb16-6"></a><span class="st">  </span><span class="kw">scale_color_mf</span>()</span></code></pre></div>
<p><img src="data-sci_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<p>Here is a summary of the analysis.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="one-way-tables.html#cb17-1"></a><span class="kw">data.frame</span>(o, e, e2_res, g2_res)</span></code></pre></div>
<pre><code>##                     o        e    e2_res    g2_res
## tall cut-leaf     926 906.1875 0.6581581  6.328906
## tall potato-leaf  288 302.0625 0.8091222 -5.240221
## dwarf cut-leaf    293 302.0625 0.5214343 -4.224967
## dwarf potato-leaf 104 100.6875 0.3301172  2.594764</code></pre>
<p>If you do not have a theoretical value, but instead want to test whether the data conform to a distribution, the test is nearly the same. Your first step is the estimate the distribution parameter(s). Then you can perform the goodness of fit test, but with degrees of freedom reduced for each estimated parameter.</p>
<p>For example, suppose sample <span class="math inline">\(n = 100\)</span> families and count the number of children <span class="math inline">\(J\)</span>, and you want to test whether the counts <span class="math inline">\(O\)</span> follow a Poisson distribution, <span class="math inline">\(X \sim Pois(\lambda)\)</span>.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="one-way-tables.html#cb19-1"></a>dat &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">j =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">5</span>, <span class="dt">o =</span> <span class="kw">c</span>(<span class="dv">19</span>, <span class="dv">26</span>, <span class="dv">29</span>, <span class="dv">13</span>, <span class="dv">10</span>, <span class="dv">3</span>))</span>
<span id="cb19-2"><a href="one-way-tables.html#cb19-2"></a><span class="kw">print</span>(dat)</span></code></pre></div>
<pre><code>##   j  o
## 1 0 19
## 2 1 26
## 3 2 29
## 4 3 13
## 5 4 10
## 6 5  3</code></pre>
<p>The ML estimate for <span class="math inline">\(\lambda\)</span> is</p>
<p><span class="math display">\[\hat{\lambda} = \frac{j_0 O_0 + j_1 O_1, + \cdots j_k O_k}{O}\]</span></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="one-way-tables.html#cb21-1"></a>lambda_hat &lt;-<span class="st"> </span><span class="kw">sum</span>(dat<span class="op">$</span>j <span class="op">*</span><span class="st"> </span>dat<span class="op">$</span>o) <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(dat<span class="op">$</span>o)</span>
<span id="cb21-2"><a href="one-way-tables.html#cb21-2"></a><span class="kw">print</span>(lambda_hat)</span></code></pre></div>
<pre><code>## [1] 1.78</code></pre>
<p>Then the expected values are</p>
<p><span class="math display">\[f(j; \lambda) = \frac{e^{-\hat{\lambda}} \hat{\lambda}^j}{j!}.\]</span></p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="one-way-tables.html#cb23-1"></a>E &lt;-<span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>lambda_hat) <span class="op">*</span><span class="st"> </span>lambda_hat<span class="op">^</span>dat<span class="op">$</span>j <span class="op">/</span><span class="st"> </span><span class="kw">factorial</span>(dat<span class="op">$</span>j) <span class="op">*</span><span class="st"> </span><span class="kw">sum</span>(dat<span class="op">$</span>o)</span>
<span id="cb23-2"><a href="one-way-tables.html#cb23-2"></a>dat &lt;-<span class="st"> </span><span class="kw">cbind</span>(dat, <span class="dt">e =</span> E)</span>
<span id="cb23-3"><a href="one-way-tables.html#cb23-3"></a><span class="kw">print</span>(dat)</span></code></pre></div>
<pre><code>##   j  o         e
## 1 0 19 16.863815
## 2 1 26 30.017590
## 3 2 29 26.715655
## 4 3 13 15.851289
## 5 4 10  7.053824
## 6 5  3  2.511161</code></pre>
<p>Compare the expected values to the observed values with the <span class="math inline">\(\chi^2\)</span> goodness of fit test.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="one-way-tables.html#cb25-1"></a>X2 &lt;-<span class="st"> </span><span class="kw">sum</span>((dat<span class="op">$</span>o <span class="op">-</span><span class="st"> </span>dat<span class="op">$</span>e)<span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span>dat<span class="op">$</span>e)</span>
<span id="cb25-2"><a href="one-way-tables.html#cb25-2"></a><span class="kw">pchisq</span>(<span class="dt">q =</span> X2, <span class="dt">df =</span> <span class="kw">nrow</span>(dat) <span class="op">-</span><span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] 0.4154322</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="one-way-tables.html#cb27-1"></a><span class="kw">chisq.test</span>(dat<span class="op">$</span>o, <span class="dt">p =</span> dat<span class="op">$</span>e <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(dat<span class="op">$</span>e))</span></code></pre></div>
<pre><code>## Warning in chisq.test(dat$o, p = dat$e/sum(dat$e)): Chi-squared approximation
## may be incorrect</code></pre>
<pre><code>## 
##  Chi-squared test for given probabilities
## 
## data:  dat$o
## X-squared = 2.8044, df = 5, p-value = 0.7301</code></pre>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="discrete-variables.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="two-way-tables.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="assets/gitbook-2.6.7/js/app.min.js"></script>
<script src="assets/gitbook-2.6.7/js/lunr.js"></script>
<script src="assets/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="assets/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["data-sci.pdf", "data-sci.epub"],
"toc": {
"collapse": "subsection"
},
"toolbar": {
"position": "static"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
